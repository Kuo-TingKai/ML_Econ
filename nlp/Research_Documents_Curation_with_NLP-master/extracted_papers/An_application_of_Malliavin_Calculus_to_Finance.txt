1
0
0
2

 

v
o
N
9
2

 

 
 
]
h
c
e
m

-
t
a
t
s
.
t
a
m
-
d
n
o
c
[
 
 

1
v
3
6
5
1
1
1
0
/
t
a
m
-
d
n
o
c
:
v
i
X
r
a

An application of Malliavin Calculus to Finance

Arturo Kohatsu-Higa† and Miquel Montero‡,†

†Department of Economics, Universitat Pompeu Fabra,

Ram´on Trias Fargas 25-27, 08005 Barcelona, Spain

‡Departament de F´ısica Fonamental, Universitat de Barcelona,

Diagonal 647, 08028 Barcelona, Spain

Abstract

In this article, we give a brief informal introduction to Malliavin Calculus for newcomers.
We apply these ideas to the simulation of Greeks in Finance. First to European-type options
where formulas can be computed explicitly and therefore can serve as testing ground. Later
we study the case of Asian options where close formulas are not available. The Greeks are
computed through Monte Carlo simulation.

1

Introduction

Malliavin Calculus is an area of research which for many years has been considered highly
theoretical and technical from the mathematical point of view. In recent years it has become
clear that there are various applications of Malliavin Calculus as far as the integration by parts
formula is concerned. Nevertheless it is still considered by the general mathematical audience
and practitioners a ﬁeld where is hard to grasp the basic ideas or to obtain new contributions.
In this article we present an informal introduction to Malliavin Calculus which we hope can
open the area to practitioners. For serious mathematical approaches to the topic we refer the
readers to the authoritative books on the matter, e.g. [1, 2, 3]. We have tried to take the spirit
of the issues to try to explain in simple terms the elements of the theory.

2 Malliavin calculus

The most common concise way Malliavin Calculus is presented in a research paper is as follows.
Let W = {Wt}t∈[0,1] be a standard one-dimensional Brownian motion deﬁned on a complete
probability space (Ω,F, P ). Assume F = {Ft}t∈[0,1] is generated by W . Let S be the space
of random variables of the form F = f (Wt1, . . . , Wtn ), where f is smooth. For F ∈ S, DtF =
Pn
f (Wt1, . . . , Wtn)1[0,ti](t). For k ∈ Z+, p ≥ 1, let Dk,p be the completion of S with the
respect to the norm

∂
∂xi

i=1

kFkk,p = (E[|F|p] + E[(

k

Xj=1Z 1

0

. . .Z 1

0 |Dj

s1,... ,sj F|2ds1 . . . dsj)p/2])1/p,

t1,... ,tj F = Dt1 . . . Dtj F . We let kFk0,p = (E[F p])1/p = kFkp and D∞ = ∩k,pDk,p. For
L2([0,1]) is deﬁned as Dk,p but with norm kukk,p,L2([0,1]) =
L2([0,1])] + E[(Pk
s1,... ,sj uk2

where Dj
processes u = {ut}t∈[0,1] on (Ω,F, P ), Dk,p
(E[kukp
operator behaves like a stochastic integral. In fact, if ut is Ft adapted, then D∗(u) =R 1

We denote by D∗(u) the Skorokhod integral or the adjoint operator of D. This adjoint
0 utdWt,

j=1R 1

0 . . .R 1

L2([0,1])ds1 . . . dsj)p/2])1/p.

0 kDj

1

There are other anticipating integrals that have some relationship with this one as e.g.
Ogawa symmetric integral. Of the formulas we will use, the following are worth mentioning,

0 utdWt, even if ut is not Ft adapted.
the

the Itˆo integral of u; see e.g. [2]. Here we write D∗(u) =R 1
utdWt −Z 1
F utdWt = F Z 1
Z 1
t dt] < ∞ — see e.g. [2]—; and

for F ∈ D1,2 and E[F 2R 1

0 u2

0

0

(DtF )utdt,

0

(1)

(2)

E(cid:20)Z 1

0

(DtF )utdt(cid:21) = E[F D∗(u)].

As a byproduct of all the above formulas one obtains the integration by parts formula. For
this, we say that F is smooth if F ∈ D∞. For a real random variable F ∈ D1,2, we denote by ψF
the Malliavin covariance matrix associated with F . That is, ψF =< DF, DF >L2[0,1]×R. One
says that the random variable is non-degenerate if F ∈ D∞ and the matrix ψF is invertible a.s.
and (det ψF )−1 ∈ ∩p≥1Lp(Ω).
The integration by parts formula of Malliavin Calculus can be brieﬂy described as follows.
Suppose that F is a non-degenerate random variable and G ∈ D∞. Then for any function
g ∈ C ∞
p (Rq) and a ﬁnite sequence of multi-indexes β, we have that there exists a random
variable H β(F, G) so that

E[gβ(F )G] = E[g(F )H β (F, G)] with

(cid:13)(cid:13)(cid:13)

H β(F, G)(cid:13)(cid:13)(cid:13)n,p ≤ C(n, p, β)(cid:13)(cid:13)det(ψF )−1(cid:13)(cid:13)

a′

p′ kFka

d,b kGkd′,b′ ,

for some constants C(n, p, β), a, b, d, p′, a′, b′, d′ and β ∈ ∪n≥1{1, ..., q}n. Here gβ denotes the
high order derivative of order l(β), the length of the multi-index β, and whose partial derivatives
are taken according the index vector β.

A gentler introduction may say that the idea behind the operator D is to diﬀerentiate a
random variable with respect to the underlying noise being this generated by the Wiener process
∂(dWs) . With this in mind one can guess
W . Therefore heuristically one may think that Ds“ = ”
how to diﬀerentiate various random variables. Some examples are

∂

DtWt = 1,

Dtf (Wt) = f ′(Wt), and

Ds(cid:18)Z 1

0

f (Wu)dWu(cid:19) = Z 1

s

f ′(Wu)dWu + f (Ws).

Here f is a C 1
following general deﬁnition.

b function. A way to understand any integration by parts formula is through the

Deﬁnition We will say that given two random variables X and Y , the integration by parts

formula is valid if for any smooth function f with bounded derivatives we have that

E[f ′(X)Y ] = E[f (X)H],

for some random variable H ≡ H(X, Y ).
let Z = f (X). Then using the chain rule we have

One can deduce an integration by parts formula through the duality principle (2). That is,

DsZ = f ′(X)DsX.

2

From here we multiply the above by Y h(s) where h is a process to be chosen appropiately. Then

DsZY h(s) = f ′(X)DsXY h(s).

Integrating this for s ∈ [0, 1], we have that

f ′(X)DsXY h(s)ds = f ′(X)Y Z 1

0

h(s)DsXds, then

0

DsZY h(s)ds =Z 1
Z 1

0

Z 1

0

with

ds = f ′(X)Y, therefore

Y DsZh(s)
0 h(v)DvXdv

R 1
E < DZ, u >L2[0,1]= E(cid:2)f ′(X)Y(cid:3) ,

Finally, we have that if D∗ is the adjoint operator of D —see equation (2)—, then

Y h(s)

.

0 h(v)DvXdv

us =

R 1

E[ZD∗(u)] = E(cid:2)f ′(X)Y(cid:3) , and

E"f (X)D∗ 

Y h(·)

0 h(v)DvXdv!# = E(cid:2)f ′(X)Y(cid:3) .
R 1

This also means that in particular for h ≡ 1 we have that
Y

H ≡ H(X, Y ) = D∗ 

0 DvXdv! .
R 1

(3)

ﬁnite (in particular the ones related to H). Note that the integral R 1

If one has higher order derivatives then one has to repeat this procedure iteratively. The use
of the norms in the spaces Dn,p is necessary in order to prove that the above expectations are
0 h(v)DvXdv should not be
degenerate with probability one. Otherwise the above argument is bound to fail. The process h
that appears in this calculation is a parameter process that can be chosen so as to obtain this
non-degeneracy. In the particular case that h(v) = DvX one obtains the so called Malliavin
covariance matrix.

In conclusion one can build diﬀerent integrations by parts formulas depending on how we
choose this process h. In the next section we use this formula in order to apply it to a concrete
problem in Finance.

3 Greeks in Finance

European options are contracts that are signed between two parties (usually a bank and a
customer) that allows to obtain certain monetary beneﬁts if the price of certain asset fall above
(call option) or below (put option) a certain ﬁxed value, the strike price, at a certain ﬁxed date,
the expiration time. A Greek is the derivative of an option price with respect to a parameter. In
general, let X ≡ X(α) be a random variable that depends on a parameter α. Suppose that the
option price is computed through a payoﬀ function in the following form P(α) = E[Φ(X(α), α)]

3

where Φ is generally non-smooth. A Greek is therefore a measure of the sensibility of this price
with respect to its parameters. In particular, it could serve to prevent future dangers in the
position of a company holding these options. The problem of computing Greeks in Finance has
been studied by various authors: [4, 5, 6, 7, 8], among others. Let us take a clooser look at the
problem. If the Leibnitz rule of interchange between expectation and diﬀerentiation were true
then we would have
∂P(α)
∂α

∂E[Φ(X(α), α)]

(4)

∂X(α)

∂Φ(X(α), α)

∂α

=

= E(cid:20)Φ′(X(α), α)

+

∂α

∂α

(cid:21) .

When the above expression does not have a close formula then one may start thinking in per-
forming some Monte Carlo simulations in order to approximate the above quantity.
If Φ is
somewhat regular then we can use the last expression above to do this: we shall call this proce-
dure the “direct method”. Unfortunately in various cases Φ is not diﬀerentiable. Then one can
resort to the use of the middle expression above to generate what is known as ﬁnite diﬀerence
method. This method has been somewhat successful in the recent past but we would like to
discuss here the application of the integration by parts pesented before in order to compute
these derivatives.

4 The European-style options

We shall illustrate how this procedure works by choosing a very special subset of the large family
of Financial derivatives: what we have called European-style options. In this class of derivatives
we will ﬁnd all the options whose payoﬀ function depends only on the value of the underlying
at the expiration time T , which is previously ﬁxed. Examples of the European-type options
are the vanillas —the more classical European calls and puts—, or the binaries —the so called
“cash-or-nothing” options—, among others. These options will diﬀer, for instance, from the
American-style options, where the execution time is not ﬁxed but belongs to an interval; and
also from the Asian-style options where the payoﬀ depends on some average of the value of the
asset in a given period of time. We will return on this topic afterwards.

The interest of the European-style options is that they are a class of derivatives whose Greeks
can be computed in closed form for particular classes of payoﬀ functions. The reason, as we will
show, is that we explicitly know the probability density function of the random variable involved,
ST , whereas in other scenarios this is not true. This peculiarity provides us with a framework
where we can easily test how Malliavin Calculus applies to the computation of Greeks. Later,
we will also make a comment on a case where this closed formulas are not available and where
this technique may prove useful.

4.1 The Malliavin expressions

Let us start deriving the formal expressions for some of the Greeks we shall deal with.

First we assume that our underlying asset S is described by a geometric Brownian motion

under the risk neutral probability P:

St = S0 +Z t

0

rSsds +Z t

0

σSs dWs,

(5)

where r is the interest rate and σ is the volatility. This model is one of the models typically
used to describe stock prices or stock indices.

Second, from the previous arguments it follows that X(α) must be in general a functional of

S. In the case of European-type options, X(α) = ST and from (5):

ST = S0e{µT +σWT },

(6)

4

where {Wt}t∈[0,T ] is the Wiener process, and µ is just r − σ2/2. Expression (6) is involved in all
the following derivations.
Now we can compute Delta, ∆, the ﬁrst partial derivative of the (discounted) expected

outcome of the option, with respect to the present value of the asset:

∆ =

∂
∂S0

E(cid:2)e−rT Φ(ST )(cid:3) =

e−rT
S0

E(cid:20) ∂ST

∂S0

Φ′(ST )(cid:21) =

e−rT
S0

E(cid:2)Φ′(ST )ST(cid:3) .

Now we may perform the integration by parts applying the formula given in (3),

∆ =

e−rT
S0

E"Φ(ST )D∗ 

ST

0 DvST dv!# ,
R T

which removes the derivative of Φ from the expectation.

(7)

The integral term appearing in the last expression will appear many times along our expo-
sition. In order to compute it we must remember the rules of the stochastic derivative stated
above:

and then

DuST = σST DuWT = σST 1u≤T ,

Z T

0

DuST = σT ST .

Then we are able to perform the stochastic integral in (7),

D∗ 

ST

0 DvST dv! = D∗ 
R T

ST

0 σST dv! = D∗(cid:18) 1
R T

σT(cid:19) =

WT
σT

,

with the help of equation (1) applied to F = 1

σT . Then the expression for ∆ reads,

∆ = E(cid:20)e−rT Φ(ST )

WT

S0σT(cid:21) .

(8)

(9)

Let us move now into a new Greek: Vega. It measures how sensitive is the price of the option

when the volatility changes,

V =

∂
∂σ

E[e−rT Φ(ST )] = e−rT E(cid:20) ∂ST

∂σ

Φ′(ST )(cid:21) = e−rT E[ST (WT − σT )Φ′(ST )].

We invoke again the recipe in Section 2 and thus we can withdraw the derivative form Φ(ST ),

where we have used the expression (8). So the computation we must face is

V = e−rT E"Φ(ST )D∗  ST (WT − σT )

0 DvST dv !# = e−rT E(cid:20)Φ(ST )D∗(cid:18) WT
R T
σT − 1(cid:19) =
D∗(cid:18) WT

D∗(WT ) − WT .

1
σT

σT − 1(cid:19)(cid:21) ,

Here a new instance of stochastic integral appears, D∗(WT ). The rule which we must take into
account in order to solve the problem is again in (1), with F = WT ,

D∗(WT ) = W 2

T −Z T

0

DsWT ds = W 2

T − T,

5

what lead us ﬁnally to this expression for V,
V = E(cid:20)e−rT (cid:26) W 2

T

σT − WT −

1

σ(cid:27) Φ(ST )(cid:21) .

(10)

The last example we will present here is one involving a second derivative: Gamma. Γ inform us
on the second order dependence of the price of the option on the actual value of the underlying,

Γ =

∂2
∂S2
0

E[e−rT Φ(ST )] =

e−rT
S2
0

E[S2

T Φ′′(ST )].

After a ﬁrst integration by parts we obtain,

Γ =

e−rT
S2
0

E"Φ′(ST )D∗ 

S2
T

0 DvST dv!# =
R T

e−rT
S2
0

E(cid:20)Φ′(ST )D∗(cid:18) ST

σT(cid:19)(cid:21) .

The stochastic integral may be simpliﬁed using once more formula (1) on F = ST

σT , leading to

D∗(cid:18) ST

σT(cid:19) =

ST
σT

D∗(1) −

1

σT Z T

0

DsST ds = ST (cid:26) WT

σT − 1(cid:27) .

Afterwards we can perform the second integration by parts, yielding:

Γ =

e−rT
S2
0

E(cid:20)Φ′(ST )ST (cid:26) WT

σT − 1(cid:27)(cid:21) =

e−rT
S2
0

E"Φ(ST )D∗ 

ST

0 DvST dv (cid:26) WT
R T

σT − 1(cid:27)!# .

The stochastic integral is now slightly cumbersome, but it does not endow any complexity that
we have not seen before,

D∗ 

ST

0 DvST dv (cid:26) WT
R T

σT − 1(cid:27)! =

1
σT

D∗(cid:18) WT

σT − 1(cid:19) =

1

σT (cid:26) WT

σT − WT −

If we bring together the previous partial results we will obtain the expression,

Γ = E(cid:20) e−rT

0σT (cid:26) WT

S2

σT − WT −

1

σ(cid:27) Φ(ST )(cid:21) .

If we compare it with (10), we ﬁnd the following relationship between V and Γ:

Γ = V
S2
0 σT

.

1

σ(cid:27) .

(11)

(12)

Since we have indeed closed expressions for all the Greeks, we may easily check the correctness
of the above statements. We shall recover property (12) of the European-style options in the
next section. The above identities are very well known by practitioners although their proofs do
not usually recall the integration by parts formula in the form we have introduced it here.

4.2 The explicit computation

The reason for the existence of such expressions for the Greeks of European-type options is due
to the fact that there is a closed and tractable formula for the probability density function of
ST . This is the lognormal distribution that is written as

p(x) =

1

x√2πσ2T

exp{−[log(x/S0) − µT ]2/2σ2T}.

6

When p(x) is available we can face the problem from a diﬀerent perspective. In this case we are
able to compute all the partial derivatives, starting from the explicit formulation for the price
of the option, P,

P = E[e−rT Φ(ST )] =Z ∞

0

e−rT Φ(x)p(x)dx,

(13)

usually just a formal expression, which now becomes handy. We can show this computing the
value of ∆, in terms of partial derivatives of p(x):

∆ =

∂

∂S0 Z ∞

0

e−rT Φ(x)p(x)dx =Z ∞

0

e−rT Φ(x)

∂p(x)
∂S0

dx =Z ∞

0

e−rT Φ(x)

∂ log p(x)

∂S0

p(x)dx.

Note that we get an expression that can be easily rewritten in a way that apparently resembles
our previous results, since one integration by parts has been implicitly done, and a kernel
naturally appears,

∆ = E"e−rT Φ(ST )(cid:18) ∂ log p(x)

∂S0 (cid:19)x=ST# .

(14)

But we have not yet exploited the information we have about the functional form of p(x),

(cid:18)∂ log p(x)

∂S0 (cid:19)x=ST

=

1

S0σ2T

[log(x/S0) − µT ]x=ST

=

WT
S0σT

,

which leads us to the same expression we have already obtain by means of Malliavin Calculus:

∆ = E(cid:20)e−rT Φ(ST )

WT

S0σT(cid:21) .

A similar procedure applies to the other Greeks. We will obtain Vega just replacing the S0

with a σ in equation (14),

V = E"e−rT Φ(ST )(cid:18) ∂ log p(x)

∂σ

(cid:19)x=ST# ,

and, after straightforward computations, we recover equation (10). The case of Gamma leads
to an expression with a very similar ﬂavor to what we have already seen,

Γ = E


e−rT Φ(ST )((cid:18) ∂ log p(x)
∂S0 (cid:19)2

+

∂2 log p(x)

∂S2
0

)x=ST

,




that yields, again, the same result presented in (11). We ﬁnd therefore in this frame that the
property stated in (12) is fulﬁlled by Vega and Gamma.

We can then conclude that when we deal with European-style options, the Malliavin-related
procedures presented above are equivalent to the result we attain if we directly diﬀerenciate the
probability density function.

7

4.3 The vanilla options

Besides the formal comparison with the previous case, the fact of knowing p(x) allows us, in
principle, to completely compute all the Greeks once a payoﬀ function has been selected. One
of the most popular choice is the European, or vanilla, call whose payoﬀ reads,

Then can be easily derived the following expressions for the Greeks we have presented:

Φ(X) = (X − K)+.

(15)

1

√2π Z d1(K)

−∞

e−x2/2dx,

e−[d1(K)]2/2, and

∆ =

V = S0r T

2π
1

Γ =

where

S0√2πσ2T

e−[d1(K)]2/2;

d1(x) =

1

σ√T (cid:20)log(S0/x) + (r +

1
2

σ2)T(cid:21) ,

as it can be found in any textbook on ﬁnancial derivatives [9].
In conclussion, we are able
to compute the diﬀerent Greeks using the Malliavin-related formulas, and compare them with
their theoretical values. We present in Fig. 1 and 2 the result of this procedure, for a given
set of parameters, after Monte Carlo simulation. Only ∆ and V are shown, since Γ would just
be a replica of the second, due to equation (12). These examples show us how the outcome
of the simulation progressively attains their own theoretical value, whereas the statistical error
reduces. We notice however that the use of what we have labeled as “direct method”, just
performing Monte Carlo simulations starting from the rhs expression in (4), would lead to an
estimator with smaller variance, and therefore a better estimation. Those estimations do not
appear in the Figures, in the sake of clarity. But we must remember that this technique can only
be applied when the payoﬀ is smooth enough. In our case, when payoﬀ follows (15), Gamma
cannot be computed in this way.

5 The Asian-style options

Here one considers the Greeks for options written on the average of the stock price 1
0 Ssds,
instead of the ﬁnal value ST , as in European options. Note that in this particular case the
density function of the random variable does not have a known closed formula. Delta in this
case is given by

T R T

∆ =

∂
∂S0

E(cid:20)e−rT Φ(cid:18) 1

T Z T

0

Ssds(cid:19)(cid:21) =

e−rT
S0

E(cid:20)Φ′(cid:18) 1

T Z T

0

Ssds(cid:19) 1

T Z T

0

Sudu(cid:21) .

There are various ways of doing the integration by parts. In the already cited literature we ﬁnd
in [7] the following expression:

∆ =

e−rT
S0

E"Φ(cid:18) 1

T Z T

0

Ssds(cid:19)  2R T
σR T

0 StdWt
0 Stdt

+ 1!# ,

8

0.8

0.6

0.4

0.2

a

t
l

e
D
d
e

 

t

a
m

i
t
s
E

0.0

0

Exact value (0.726)

Exact value (2.53)
Direct method (0.294)

4.0

3.0

2.0

1.0

r
o

t

a
m

i
t
s
e

 

e
h

t
 
f

o

 

e
c
n
a
i
r
a
V

0.0

0

2000

4000

6000

8000

10000

2000

4000

6000

8000

10000

Number of simulations

Figure 1: Estimated value of Delta for an European call with parameters r = 0.1, σ = 0.2,
T = 1.0 (in years) and S0 = K = 100 (in arbitrary cash units), using Monte Carlo techniques.

whereas a close variant of it, which involves (5), can be found in [8]:

∆ =

2e−rT

S0σ2 E"Φ(cid:18) 1

T Z T

0

Ssds(cid:19)  ST − S0

0 Stdt − µ!# .
R T

Of course, we may also use the same approach we have present in the previous sections, and
obtain a third one:

∆ =

e−rT
S0

where

E(cid:20)Φ(cid:18) 1

T Z T

0

Ssds(cid:19)(cid:18) 1

< S >(cid:26) WT

σ

+

< S2 >

< S > (cid:27) − 1(cid:19)(cid:21) ,

< S > = R T
R T
< S2 > = R T
R T

0 tStdt
0 Svdv
0 t2Stdt
0 Svdv

, and

,

are something similar to a ﬁrst two moments.

Although the two ﬁrst expressions for ∆ are statistically identical, their particular realiza-
tions when perfoming numerical computation will slightly diﬀer, even though the same series
of random numbers is used. The last formula is deﬁnitely a brand new estimator with its own
properties, among them its smaller variance is perhaps the most relevant one. We can observe
these features in Fig. 3, where we show the outcome of the Monte Carlo simulation using the
three alternative instances. We have chosen again the functional form in (15) for the payoﬀ, and
the rest of parameters takes the same value we used in the making of the previous plots.

9

70

20

−30

a
g
e
V
d
e

 

t

a
m

i
t
s
E

200000

150000

100000

50000

r
o

t

a
m

i
t
s
e

 

e
h

t
 
f

o

 

e
c
n
a
i
r
a
V

Exact value (33.32)

Exact value (86835)
Direct method (6215)

0

0

2000

4000

6000

8000

10000

−80

0

2000

4000

6000

8000

10000

Number of simulations

Figure 2: Estimated value of Vega for an European call with parameters r = 0.1, σ = 0.2,
T = 1.0 (in years) and S0 = K = 100 (in arbitrary cash units), using Monte Carlo techniques.

Then, not all these formulas coincide and in fact, contrary to what is claimed in [8] there
is no way to obtain the integration by parts that provides the minimal variance. The main
reason being that this is equivalent to know the probability density of the random variable in
question. To expose the main ideas that also appear in [8] one can note ﬁrst that there is an
integration by parts that is the “most” straightforward but highly unrealistic. For this, consider
the generalized problem

E(cid:20)Φ′(cid:18)Z T
Here p denotes the density of R T

0

0 Ssds which exists and is smooth (it is an interesting exercise of
Malliavin Calculus). Therefore one can perform the integration by parts directly in the above
formula thus obtaining that

Ssds(cid:19)Z T

0

Ssds(cid:21) =Z ∞

0

Φ′(x)xp(x)dx.

E(cid:20)Φ′(cid:18)Z T

0

Ssds(cid:19)Z T

0

Ssds(cid:21) = Z ∞

0

Φ(x)(p(x) + xp′(x))dx

= E"Φ(cid:18)Z T

0

Ssds(cid:19) · 1 + R T

0 Ssds)

0 Ssdsp′(R T
p(R T

0 Ssds)

!# .

Now we procceed to prove that the above gives the minimal integration by parts in the sense of
variance. Obviously it is not possible to carry out the simulations unless p′ and p are known.
Let us construct the set of all possible integration by parts. Suppose that Y is a random variable
such that

E(cid:20)Φ′(cid:18)Z T

0

Ssds(cid:19)Z T

0

Ssds(cid:21) = E(cid:20)Φ(cid:18)Z T

0

Ssds(cid:19) Y(cid:21) ,

10

a
t
l
e
D
 
d
e
t
a
m

i
t
s
E

0.90

0.85

0.80

0.75

0.70

0.65

0

3.0

2.8

2.6

2.4

2.2

r
o

t

a
m

i
t
s
e

 

e
h

t
 
f

o

 

e
c
n
a
i
r
a
V

2.0

0

2000

4000

6000

8000

10000

2000

4000

6000

8000

10000

Number of simulations

Figure 3: Computed value of Delta for an Asian call with parameters r = 0.1, σ = 0.2, T = 1.0
(in years) and S0 = K = 100 (in arbitrary cash units), using Monte Carlo techniques, for the
estimators presented in the main text. We have broken the interval of integration in 252 pieces,
representing the approximate number of trading days in a year. The exact result turns out to
be near the bottom of the graph, at about 0.65.

for any function Φ ∈ C +∞

p

, then it is not diﬃcult to deduce that

E(cid:20)Y (cid:30)σ(cid:18)Z T

0

Ssds(cid:19)(cid:21) = 1 + R T

0 Ssds)

.

0 Ssdsp′(R T
p(R T

0 Ssds)

Here σ(x) denotes the σ-algebra generated by x, and E[·/·] is the conditional expectation.
Therefore the set of all possible integration by parts can be characterized as

M =(Y ∈ L2(Ω); E(cid:20)Y (cid:30)σ(cid:18)Z T

0

Ssds(cid:19)(cid:21) = 1 + R T

Next in order we want to ﬁnd the element in Y that minimizes

0 Ssds)

0 Ssdsp′(R T
p(R T

0 Ssds)

) .

inf
Y ∈M

E"Φ(cid:18)Z T

0

Ssds(cid:19)

2

Y 2# .

As in [8] is not diﬃcult to see which Y achieves the minimum. This is done as follows:

2

E"Φ(cid:18)Z T

0

Ssds(cid:19)

Y 2# = E

+E


2

0

Φ(cid:18)Z T
Φ(cid:18)Z T

Ssds(cid:19)
Ssds(cid:19)

0

11

0 Ssds)

0 Ssds)

2

· Y − 1 − R T
· 1 + R T

0 Ssdsp′(R T
p(R T
0 Ssdsp′(R T
p(R T

0 Ssds)

0 Ssds)

!2

!2


,

since the mixed product is 0, due to the property of the set M. Therefore the minimum is
achieved at Y = (cid:18)1 + R T
(cid:19). This is clearly impossible to write explicitely as p

is unknown in the case of Asian options. Therefore it is still an open problem to devise good
ways to perform an eﬃcient integration by parts so that the variance is made small rapidly and
eﬃciently.

0 Ssds)

0 Ssdsp′(R T
p(R T

0 Ssds)

Acknowledgements

AKH would like to thank Prof. S. Ogawa for his kind invitation to visit Japan, and participate in
the workshop. He would also like to thank all the comments received about the presentation of
this work. MM has been supported in part by Direcci´on General de Proyectos de Investigaci´on
under contract No.BFM2000-0795, and by Generalitat de Catalunya under contract No.2000
SGR-00023.

References

[1] Ikeda N. and Watanabe S., Stochastic Diﬀerential Equations and Diﬀusion Processes, North-

Holland, Amsterdam (1989).

[2] Nualart D., The Malliavin Calculus and Related Topics, Springer, Berlin (1995).

[3] Malliavin P., Market curvature and importance sampling of Ocone-Karatzas hedging. Con-

ference on Stochastic Analysis, Berlin (July 2001).

[4] Broadie M. and Glasserman P., “Estimating Security Price Derivatives Using Simulation”,

Manag. Sci., 42, 269-285 (1996).

[5] Benhamou E., “An application of Malliavin Calculus to continuous time Asian Options

Greeks”. Technical report, London School of Economics (2000).

[6] L’Ecuyer P., and Perron G., “On the convergence rates of IPA and FDC derivative estima-

tors”,Oper. Res., 42, 643-656 (1994).

[7] Fourni´e E., Lasry J.M., Lebuchoux J., Lions P.L., and Touzi N., “Applications of Malliavin

calculus to Monte Carlo methods in ﬁnance”, Finance Stochast., 3, 391-412, (1999)

[8] Fourni´e E., Lasry J.M., Lebuchoux J., and Lions P.L., “Applications of Malliavin calculus

to Monte Carlo methods in ﬁnance. II”, Finance Stochast., 5, 201-236 (2001)

[9] Wilmott, P., Derivatives, Wiley, Chichester (1998).

12

