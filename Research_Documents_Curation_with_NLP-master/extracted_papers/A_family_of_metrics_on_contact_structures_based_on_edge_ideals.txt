3
0
0
2

 

n
u
J
 

6
1

 
 
]

M
D
.
s
c
[
 
 

1
v
7
9
0
6
0
3
0
/
s
c
:
v
i
X
r
a

A family of metrics on contact structures based on edge

ideals∗

M. Llabr´es, F. Rossell´o

Dept. of Mathematics and Computer Science,

Research Institute of Health Science (IUNICS),

University of the Balearic Islands,

07122 Palma de Mallorca (Spain)

E-mail: {merce.llabres,cesc.rossello}@uib.es

September 28, 2017

Abstract

The measurement of the similarity of RNA secondary structures, and in general of
contact structures, of a ﬁxed length has several speciﬁc applications. For instance, it
is used in the analysis of the ensemble of suboptimal secondary structures generated by
a given algorithm on a given RNA sequence, and in the comparison of the secondary
structures predicted by diﬀerent algorithms on a given RNA molecule. It is also a useful
tool in the quantitative study of sequence-structure maps. A way to measure this similarity
is by means of metrics. In this paper we introduce a new class of metrics dm, m ≥ 3, on
the set of all contact structures of a ﬁxed length, based on their representation by means
of edge ideals in a polynomial ring. These metrics can be expressed in terms of Hilbert
functions of monomial ideals, which allows the use of several public domain computer
algebra systems to compute them. We study some abstract properties of these metrics,
and we obtain explicit descriptions of them for m = 3, 4 on arbitrary contact structures
and for m = 5, 6 on RNA secondary structures.

Keywords: contact structure, RNA secondary structure, metric, distance, monomial
ideal, Hilbert function.

1 Introduction

As it is well known, in the cell and in vitro RNA molecules and proteins fold into three-
dimensional structures, which determine their biochemical function. A central problem in
molecular biology is the study of these structures, their prediction and comparison. As diﬀerent
levels of precision are suitable for diﬀerent problems, we can sometimes forget about the detailed
description of the three-dimensional structure of a biopolymer and simply focus our attention
on what has been called its contact structure: the set of all pairs of monomers (nucleotides in

∗This work has been partially supported by the Spanish DGES, grant BFM2000-1113-C02-01.

1

RNA molecules, aminoacids in proteins) that are spatial neighbors in the three-dimensional
structure [4]. If we assume the monomers numbered from 1 to n along the backbone of the
polymer, then a contact structure can be understood as an undirected graph without multiple
edges or self-loops with set of nodes {1, . . . , n}: its edges are consistently called contacts and
its number n of nodes its length.

The secondary structures of RNA molecules form a special class of contact structures. In
them, contacts represent the hydrogen bonds between pairs of bases that held together the
three-dimensional structure. A hydrogen bond can only form between bases that are several
positions apart in the chain, but we shall not take this restriction into account here and we shall
impose that a contact can only exist between non-consecutive bases. A restriction is added
to the deﬁnition of RNA secondary structure: a base can only pair with at most one base.
This restriction is called the unique bonds condition and it is speciﬁc of secondary structures.
It is usual to impose a further restriction on RNA secondary structures, by forbidding the
existence of (pseudo)knots: a contact between bases at the ith and jth positions in the backbone
cannot coexist with a contact between bases at the kth and lth positions if i < k < j < l.
This restriction has its origin in the ﬁrst dynamic programming methods to predict RNA
secondary structures [25, 27, 28], but since real RNA structures can contain knots, which are
moreover important structural elements in many RNA molecules, and their existence does not
compromise our models, we shall not impose this restriction here.

Contact structures with unique bonds can also be used to represent the basic building blocks
of protein structures, like α-helixes, β-sheets and β and Ω-turns (called thus protein secondary
structures), which are also held together by means of hydrogen bonds between non-consecutive
aminoacids.

But, beyond secondary structures, the representation of the neighborhood in three-dimensio-
nal structures of RNA molecules and proteins needs contact structures without unique bonds.
The full three-dimensional structure of RNA molecules contains contacts that violate the unique
bonds condition, like base triplets and guanine platforms [1, 16]. And in the tertiary structure
of a protein, represented for instance by means of a self-avoiding walk in a lattice (i.e., a path
in N3 that does not visit the same node more than once [14]), one aminoacid can be spatial
neighbor of several aminoacids [5, 7]. But even in this general case, the existence of contacts
between pairs of monomers that are next to each other in the backbone is still forbidden in
contact structures, because their spatial closeness can be understood as a consequence of their
position in the backbone.

As we mentioned, an important problem in molecular biology is the comparison of the three-
dimensional structures formed by RNA molecules and proteins, because it is assumed that
a preserved three-dimensional structure corresponds to a preserved function. Moreover, the
measurement of the similarity of contact structures on biopolymers of a ﬁxed length has an
interest in itself. For instance, it can be used in the analysis of the ensemble of suboptimal
solutions provided by a given algorithm, like for instance Zuker’s algorithm [26], to the problem
of determining the secondary structure of a given RNA molecule; see [27, 17]. It can also be used
to compare the output of diﬀerent prediction algorithms applied to the same RNA molecule
or protein, to assess their performance. This similarity measurement lies also at the basis of
the study of the mapping that assigns to each RNA molecule or protein the structure it folds
into [9, 21] and it can be used in the study of phenotype spaces [10].

The similarity of contact structures can be quantiﬁed by means of metrics on the set of all
contact structures of a given length. For instance, with the purpose of comparing suboptimal

2

solutions to the RNA secondary structure prediction problem in order to reduce the number of
alternate structures obtained by his algorithm, Zuker introduced from the very beginning its
metric dZ [26, 27] and more recently the mountain metrics [17]. Tree editing distances have
also been used in this context [13, 17, 20].

Reidys and Stadler deﬁned in their seminal paper [18] on algebraic models of biopolymer
structures three metrics on RNA secondary structures of ﬁxed length n, based on their repre-
sentations as involutions and as permutation subgroups, and on Magarshak’s matrix represen-
tation [15], and they discussed their biophysical relevance. These metrics have been recently
analyzed from the mathematical point of view [8, 19].

Since their models cannot be used to represent in a one-to-one way contact structures without
unique bonds, Reidys and Stadler’s metrics cannot be extended to the set of arbitrary contact
structures of a ﬁxed length.
In this paper we overcome this drawback, by switching from
subgroups of the symmetric group Sn to monomial ideals of a polynomial ring in n variables.
More speciﬁcally, we represent a contact structure by means of its edge ideal. Edge ideals are
a quite popular tool in commutative algebra to represent graphs and to study their properties
[23, 24]. By using them, we generalize Reidys and Stadler’s subgroup metric to deﬁne a metric
through their permutation subgroups model, to deﬁne a family of metrics (dm)m≥3 on the set
of all contact structures of a ﬁxed length. Up to our knowledge, these are the ﬁrst metrics
deﬁned on arbitrary contact structures of a ﬁxed length that are independent of any notion of
graph edition. We express these metrics in terms of Hilbert functions, which makes them easily
computable using several public domain computer algebra systems like for instance, CoCoA [3]
or Macaulay [11]. We also obtain explicit expressions for several of these metrics on contact
and RNA secondary structures, which allow to grasp the notion of similarity they measure.

We hope that our metrics will increase the range of sensible metrics available in the applica-
tions of the comparison of structures of a ﬁxed length mentioned above: as Moulton, Zuker et
al point out, “[. . . ] generally speaking, it is probably safest to try as many metrics as possible”
[17, p. 290].

2 Preliminaries

In this section we recall some deﬁnitions and facts on contact and RNA secondary structures,
and we take the opportunity to ﬁx nome notations and conventions that we shall use henceforth,
usually without any further notice.
Contact structures and RNA secondary structures. From now on, let [n] denote the
set {1, . . . , n}, for every positive integer n. We begin by recalling the deﬁnition of contact
structure from [18, 22]; contact structures are also called diagrams in [12].

Deﬁnition 1 A contact structure of length n is an undirected graph without multiple edges
or self-loops Γ = ([n], Q), for some n > 1, whose arcs {i, j} ∈ Q, called contacts, satisfy the
following condition:

i) For every i ∈ [n], {i, i + 1} /∈ Q.

A contact structure has unique bonds when it satisﬁes the following extra condition:

ii) For every i ∈ [n], if {i, j}, {i, k} ∈ Q, then j = k.

Condition (i) translates the impossibility of a contact between two consecutive monomers,
while condition (ii) translates the unique bonds condition in RNA secondary structures men-

3

tioned in the introduction. We shall call the contact structures with unique bonds RNA sec-
ondary structures. As we mentioned in the Introduction, the conventional deﬁnition of RNA
secondary structure forbids moreover the existence of pseudoknots (pairs of contacts {i, j} and
{k, l} such that i < k < j < l), but we shall not impose this restriction here.

We shall denote from now on a contact {j, k} by j ·k or k·j, without distinction. A node is

said to be isolated in a contact structure when it is not involved in any contact.

We shall often represent speciﬁc RNA secondary structures without pseudoknots by means
of their bracket representation [13], obtained by replacing in the sequence [n] each contact i·j
with i < j by a “(” in the ith position and a “)” in the jth position, and each isolated node
by a dot in the corresponding position. For instance,

represents the secondary structure

((((((...)))))..((...)).)

(cid:16)[25], {1·25, 2·14, 3·13, 4·12, 5·11, 6·10, 17·23, 18·22}(cid:17).

Knotted RNA secondary structures admit a similar representation, using diﬀerent types of
brackets to represent contacts in order to avoid ambiguities.

Given two contact structures of the same length Γ1 = ([n], Q1), Γ2 = ([n], Q2), their union

is the contact structure

Γ1 ∪ Γ2 = ([n], Q1 ∪ Q2).

From now on, and unless otherwise stated, given any contact structure Γ or Γi, i = 1, 2, . . .,

we shall always denote its set of contacts by Q or Qi, respectively.

Let Cn and Sn denote the sets of all contact structures and of all RNA secondary structures

of length n, respectively.
Subgroup metric. For every n > 1, let Sn be the symmetric group of permutations of [n].
In [18], Reidys and Stadler associated to every RNA secondary structure Γ ∈ Sn the subgroup
G(Γ) of Sn generated by the set of the transpositions corresponding to the contacts in Γ:

G(Γ) = h{(i, j) | i·j ∈ Q}i.

They also proved that the mapping Γ 7→ G(Γ) is an embedding of Sn into the set Sub(Sn) of
subgroups of Sn, and they used this representation of RNA secondary structures as permutation
subgroups to deﬁne the following subgroup metric:

dsgr : Sn × Sn → R

(Γ1, Γ2)

7→ ln(cid:12)(cid:12)(cid:12)(cid:12)

G(Γ1) · G(Γ2)

G(Γ1) ∩ G(Γ2)(cid:12)(cid:12)(cid:12)(cid:12)

In [19] it was proved that this metric simply measures, up to a scalar factor, the cardinal
|Q1∆Q2| of the symmetric diﬀerence of the sets of contacts.

Unfortunately, if we extend the mapping G to the set Cn of all contact structures of length

n, we no longer obtain an embedding into Sub(Sn), as the following easy example shows.

Example 1 Let Γ1 = ([5], Q1) and Γ2 = ([5], Q2) be contact structures with sets of contacts

Q1 = {1·3, 3·5}, Q2 = {1·5, 3·5}.

4

see Fig. 1. Then G(Γ1) = h(1, 3), (3, 5)i and G(Γ2) = h(1, 5), (3, 5)i are both equal to

{Id, (1, 3), (1, 5), (3, 5), (1, 3, 5), (1, 5, 3)}.

...................

..................

...................

..................

...................

...................

...................

..................

...................

...................

.................
..................
...................
...................
..................

s

1

..................

..................
.................
.................
..................
..................
...................
...................
...................
...................
..................
.
.
...................
s
3
...................
..................
.................
..................
...................

...................

..................
.................
..................
...................
...................
..................
...................
5
...................
..................
.................
..................
...................

.
s

Q1

Q2

s

2

s

4

✫ ✪

...................

...................

..................

Figure 1: The contact structures in Example 1.

This entails in particular that the subgroup metric, when extended to the set Cn, yields only
a pseudodistance: it is nonnegative and symmetric and satisﬁes the triangular inequality, but
dsgr(Γ1, Γ2) = 0 does not imply Γ1 = Γ2. The scope of the failure of the separability condition
is determined by the following result.

Proposition 2 For every Γ1, Γ2 ∈ Cn, dsgr(Γ1, Γ2) = 0 if and only if for every i·j ∈ Γ1 there
exists a chain of contacts k1·k2, k2·k3, . . . , km−2·km−1, km−1·km in Γ2 with m > 2, k1 = i and
km = j, and vice versa, for every i·j ∈ Γ2 there is a similar chain of contacts in Γ1 going from
i to j.

Proof. By [18, Thm. 5], dsgr(Γ1, Γ2) = 0 if and only if G(Γ1) = G(Γ2), i.e., if and only if every
transposition corresponding to a contact in Γ1 is a product of transpositions corresponding
to contacts in Γ2, and vice versa, every transposition corresponding to a contact in Γ2 is a
product of transpositions corresponding to contacts in Γ1, a condition that is equivalent to the
one given in the statement.
Orbits. Reidys and Stadler also represented an RNA secondary structure Γ ∈ Sn with set of
contacts Q = {i1·j1, . . . , ik ·jk} by the involution1

π(Γ) =

k

(it, jt) ∈ Sn.

Yt=1

They also proved that this construction yields and embedding π : Sn ֒→ Sn, which they used
to induce metrics on Sn from metrics on Sn [12, 18].

For every Γ1, Γ2 ∈ Sn, let D(Γ1, Γ2) = hπ(Γ1), π(Γ2)i ∈ Sub(Sn) be the dihedral subgroup
of Sn generated by the involutions associated to them. This subgroup acts on [n]. The orbits
induced by this action can be understood as subsets {i1, i2, . . . , im} ⊆ [n], m > 1, such that

i1·i2, i2·i3, . . . , im−1·im ∈ Q1 ∪ Q2

1Notice that this product is only well-deﬁned if the transpositions appearing in it commute with each other,
and thus this deﬁnition does not make sense for arbitrary contact structures, at least unless some convention is
introduced on the order how these transpositions must be composed; we shall not consider this problem here.

5

and maximal with this property, i.e., such that any other contact in Q1 ∪ Q2 involving some
element of this subset can only be i1 ·im. Notice that these orbits are exactly the connected
components of the graph Γ1 ∪ Γ2. The unique bonds condition (or, in group-theoretical terms,
the fact that π(Γ1) and π(Γ2) are involutions) implies that if {i1, i2, . . . , im} is such an orbit,
then i1 ·i2, i3 ·i4, . . . belong to one of the sets Q1 or Q2 and i2 ·i3, i4·i5, . . . belong to the other
one.

Such an orbit is cyclic if m = 2 and i1·i2 ∈ Q1 ∩ Q2, or m > 3 and i1·im ∈ Q1 ∪ Q2, and it is
linear in all other cases: see Fig. 2. We shall call the cardinal of an orbit its length. The length
of a cyclic orbit is always even: if i1 ·i2 ∈ Q1 in a cyclic orbit {i1, i2, . . . , im}, then i1 ·im ∈ Q2
and hence im−1·im ∈ Q1.

(a)

i1

(b)

i1

..................................................
..................................................
..........
..........
..........
..........
..........
..........
.........
.........
.........
.........
..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
.
.
...........
...........
..........
..........
❝
❝
❝
❝
..........
..........
..........
..........
i5
i3
i4
i2
..........
..........
..........
..........
.........
.........
.........
.........
.......... .......... .......... .......... .......... .......... .......... ..........
.......... .......... .......... .......... .......... .......... .......... ..........

q

q

q

q

q

q

q

q

q

❝

q

q

q

✫

q

q

q

❝

❝

q
q
q
q
q
q
..................................................
..................................................
..........
..........
..........
..........
..........
..........
.........
.........
.........
.........
..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
.
.
...........
...........
..........
..........
..........
..........
..........
..........
i5
i3
i2
i4
..........
..........
..........
..........
.........
.........
.........
.........
.......... .......... .......... .......... .......... .......... .......... ..........
.......... .......... .......... .......... .......... .......... .......... ..........

❝

❝

q

q

q

❝

q

q

q

. . .

q

q

q

q

. . .

q

..................................................
..........
..........
..........
.........
.........
..........
..........
..........
..........
..........
..........
.
❝
❝
im
im−1

q

q

q

q

q

Q1

Q2

✪

q

q

❝

q
q
q
..................................................
..........
..........
..........
.........
.........
..........
..........
..........
..........
..........
..........
.
...........
..........
..........
..........
im−1
im−2
..........
..........
.........
.........
.......... .......... .......... .......... .......... .......... .......... ..........

❝

im

q

q

q

❝

Q1

Q2

Figure 2: A cyclic orbit of length m (a) and a linear orbit of length m (b).

An orbit is trivial when it is a singleton:

is isolated in both Γ1 and Γ2.
i3, . . . , im−1·im ∈ Q1 ∪ Q2 and i1 ·im /∈ Q1 ∪ Q2, then i1, im are its end points.

it is a linear orbit consisting of a node that it
If {i1, i2, . . . , im} is a non-trivial linear orbit with i1 · i2, i2 ·

We shall say that a contact i·j ∈ Q1 ∪ Q2 is involved in an orbit when its vertices i, j belong
to this orbit. Every contact in Q1 ∪ Q2 is involved in one and only one orbit, and a contact
belongs to Q1∆Q2 if and only if it is involved in a linear orbit or in a cyclic orbit of length
m > 2.

Let, for every k > 2,

Λ(m), Λ≥k, Θ(m)

denote, respectively, the number of linear orbits of length m, the number of linear orbits of
length m > k and the number of cyclic orbits of length m induced by the action of D(Γ1, Γ2)
on [n]. Since a cyclic orbit of length m involves m contacts, and a linear orbit of length m
involves m − 1 contacts, we have that

|Q1∆Q2| = Xm≥4

mΘ(m) + Xm≥2

(m − 1)Λ(m).

3 A family of metrics based on edge ideals

Let n be from now on an integer greater than 2. Let M(x1, . . . , xn), or simply M(x), be the set
of all monomials in the variables x1, . . . , xn. We shall denote a monomial xα1
n ∈ M(x)
by x(α1,...,αn) or simply by xα if we let α stand for the n-tuple (α1, . . . , αn). The total degree

1 · · · xαn

of a monomial x(α1,...,αn) is Pn

i=1 αi. For every m > 0,

6

• let M(x)(m) be the set of all monomials in M(x) of total degree m, and

• let M(x)m be the set of all monomials in M(x) of total degree 6 m.

Recall that

|M(x)m| =(cid:18)n + m

n (cid:19) and |M(x)(m)| =(cid:18)n + m − 1
n − 1 (cid:19).

Let F2 be the ﬁeld Z/2Z and F2[x1, . . . , xn], or simply F2[x], the ring of polynomials in the
variables x1, . . . , xn with coeﬃcients in F2. Let Id(F2[x]) denote the set of ideals of F2[x]. For
every I ∈ Id(F2[x]) and for every m > 0,

• let M (I) = I ∩ M(x) be the set of all monomials that belong to I;

• let M (I)(m) = I ∩ M(x)(m) be the set of all monomials of total degree m that belong

to I;

• let M (I)m = I ∩ M(x)m be the set of all monomials of total degree 6 m that belong

to I;

• let C(I) = M(x) − M (I) be the set of all monomials that do not belong to I; and

• let C(I)m = C(I) ∩ M(x)m be the set of all monomials of total degree 6 m that do not

belong to I.

An ideal I of F2[x] is monomial when it is generated by a set of monomials. It should be
recalled that, given a monomial ideal I generated by a set of monomials M , the monomials in
M (I) are exactly those that are divisible by some monomial in M and the polynomials in I are
exactly the linear combinations (with coeﬃcients in F2) of monomials in M (I); in particular,
for every two monomial ideals I and J of F2[x], I = J if and only if M (I) = M (J).

Deﬁnition 2 For every Γ = ([n], Q) ∈ Cn, the edge ideal IΓ of Γ is the monomial ideal of
F2[x] generated by the products of pairs of variables whose indexes form a contact in Γ:

IΓ = h{xixj | i·j ∈ Q}i.

Proposition 3 The mapping I : Cn → Id(F2[x]) that sends every Γ ∈ Cn to its edge ideal, is
an embedding.

Proof. For every Γ ∈ Cn, the monomials in IΓ are exactly those divisible by some xixj with
i·j ∈ Q. This implies that

M (IΓ)(2) = {xixj | i·j ∈ Q},

and therefore Γ is uniquely determined by M (IΓ)(2).

7

Given two contact structures Γ1, Γ2 ∈ Cn, it is clear that

IΓ1 + IΓ2 =D{xixj | i·j ∈ Q1} ∪ {xixj | i·j ∈ Q2}E = IΓ1∪Γ2.

As far as IΓ1 ∩ IΓ2 goes, it is straightforward to prove that it is generated by

{xixj | i·j ∈ Q1 ∩ Q2} ∪ {xixjxk | i·j ∈ Q1 − Q2, j ·k ∈ Q2 − Q1}

∪{xixjxkxl | i·j ∈ Q1 − Q2, k·l ∈ Q2 − Q1, {i, j} ∩ {k, l} 6= ∅}.

Using a construction similar to the one introduced by Reidys and Stadler for subgroups, we
want to measure the diﬀerence between two contact structures Γ1, Γ2 ∈ Cn by means of the
quotient (IΓ1 + IΓ2)/(IΓ1 ∩ IΓ2 ). Notice that this quotient is a singleton if and only if IΓ1 = IΓ2 ,
i.e., if and only if Γ1 = Γ2. Unfortunately, in all other cases this quotient is inﬁnite:
if a
monomial xα belongs to, say, IΓ1 − IΓ2 , then all its powers deﬁne pairwise diﬀerent equivalence
classes modulo IΓ1 ∩ IΓ2 Thus, to obtain a “ﬁnite distance” we move to quotients of F2[x].

For every n > 1 and m > 3, let us consider the quotient ring

Rn,m = F2[x1, . . . , xn]/hM(x)(m)i,

and let πm : F2[x1, . . . , xn] → Rn,m be the corresponding quotient ring homomorphism. For
every I ∈ Id(F2[x1, . . . , xn]), let πm(I) be the image of I in Rn,m.

Proposition 4 For every m > 3, the mapping d′

m : Cn × Cn → R deﬁned by

is a metric on Cn.

d′

m(Γ1, Γ2) = log2(cid:12)(cid:12)(cid:12)(cid:12)

πm(IΓ1 ) + πm(IΓ2 )

πm(IΓ1 ) ∩ πm(IΓ2 )(cid:12)(cid:12)(cid:12)(cid:12)

Proof. When we perform the quotient Rn,m = F2[x]/hM(x)(m)i, all monomials with total
degree greater or equal than m are cancelled. Then, each element in Rn,m has a unique
representative that is a linear combination with coeﬃcients in F2 of monomials of total degree
at most m − 1. Since F2 is a ﬁnite ﬁeld, this implies that Rn,m is ﬁnite, and in particular it is
a ﬁnite commutative group with the sum of quotient classes of polynomials as operation. Let
Sub(Rn,m) denote its set of subgroups.

On the other hand, since m > 3, the quotient homomorphism πm does not identify any
monomial of total degree 2 with any other monomial. Thus, πm(IΓ1 ) = πm(IΓ2 ) implies
M (IΓ1 )(2) = M (IΓ2 )(2) and hence, as we saw in Proposition 3, Γ1 = Γ2. In other words, the
mapping πm ◦ I : Cn → Sub(Rn,m) sending every Γ ∈ Cn to πm(IΓ), is an embedding.

Then, since by [18, Thm. 5] the mapping

is a metric on Sub(Rn,m), the mapping

Ψ(I, J) = log2(cid:12)(cid:12)(cid:12)(cid:12)

,

I, J ∈ Sub(Rn,m)

I + J

I ∩ J(cid:12)(cid:12)(cid:12)(cid:12)

d′
m(Γ1, Γ2) = Ψ(πm(IΓ1 ), πm(IΓ2 )), Γ1, Γ2 ∈ Cn

is a metric on Cn, as we claimed.

8

We have used log2 instead of ln in the deﬁnition of d′

m in order to avoid unnecessary scalar

factors: cf. [19, Prop. 4].

These metrics d′

m have a simple description in terms of symmetric diﬀerences of sets of

monomials.

Proposition 5 For every m > 3 and for every Γ1, Γ2 ∈ Cn,

d′
m(Γ1, Γ2) = |M (IΓ1 )m−1∆M (IΓ2 )m−1|.

Proof. Notice that, for every I ∈ Id(F2[x]),

πm(I) = πm(I + hM(x)(m)i).

Then, for every Γ1, Γ2 ∈ Cn,

πm(IΓ1 ) + πm(IΓ2 )
πm(IΓ1 ) ∩ πm(IΓ2 )

=

=

∼=

=

πm(IΓ1 + hM(x)(m)i) + πm(IΓ2 + hM(x)(m)i)
πm(IΓ1 + hM(x)(m)i) ∩ πm(IΓ2 + hM(x)(m)i)

πm(cid:16)(IΓ1 + M(x)(m)i) + (IΓ2 + hM(x)(m)i)(cid:17)
πm(cid:16)(IΓ1 + hM(x)(m)i) ∩ (IΓ2 + hM(x)(m)i)(cid:17)

(IΓ1 + hM(x)(m)i) + (IΓ2 + hM(x)(m)i)
(IΓ1 + hM(x)(m)i) ∩ (IΓ2 + hM(x)(m)i)
IΓ1 + IΓ2 + hM(x)(m)i
(IΓ1 ∩ IΓ2 ) + hM(x)(m)i

,

where the equality

(IΓ1 + hM(x)(m)i) ∩ (IΓ2 + hM(x)(m)i) = (IΓ1 ∩ IΓ2 ) + hM(x)(m)i

used in the last step holds because IΓ1 , IΓ2 and hM(x)(m)i are monomial ideals.

To simplify the notations, set

so that

J = IΓ1 + IΓ2 + hM(x)(m)i,
K = (IΓ1 ∩ IΓ2 ) + hM(x)(m)i,

πm(IΓ1 ) + πm(IΓ2 )
πm(IΓ1 ) ∩ πm(IΓ2 )

∼=

J
K

.

These ideals J and K are also monomial and

M (J) = M (IΓ1 )m−1 ∪ M (IΓ2 )m−1 ∪Sr>m−1 M(x)(r),
M (K) = (M (IΓ1 )m−1 ∩ M (IΓ2 )m−1) ∪Sr>m−1 M(x)(r).

A polynomial belongs to J (resp. to K) if and only if it is a linear combination, with coeﬃcients
in F2, of elements of M (J) (resp. of M (K)). This implies that every quotient class in J/K has
xα for some ﬁnite subset M0 of M (J) − M (K)

a unique representative of the form Pxα∈M0

(the zero class corresponds to M0 = ∅). Since

M (J) − M (K) = (M (IΓ1 )m−1 ∪ M (IΓ2 )m−1) − (M (IΓ1 )m−1 ∩ M (IΓ2 )m−1)

= M (IΓ1 )m−1∆M (IΓ2 )m−1

9

is a ﬁnite set, this implies that

(cid:12)(cid:12)(cid:12)(cid:12)

πm(IΓ1 ) + πm(IΓ2 )

πm(IΓ1 ) ∩ πm(IΓ2 )(cid:12)(cid:12)(cid:12)(cid:12)

=(cid:12)(cid:12)(cid:12)(cid:12)

J

K(cid:12)(cid:12)(cid:12)(cid:12)

as we claimed.

= 2|M(IΓ1 )m−1∆M(IΓ2 )m−1|,

Proposition 5 allows us to express the metrics d′

m in terms of Hilbert functions. For every

monomial ideal I of F2[x] and for every m > 0, let HI : N → N be the mapping deﬁned by

HI (m) = |C(I)m|, m ∈ N;

i.e., HI (m) is the number of monomials of total degree 6 m that do not belong to I. This
mapping is called the (aﬃne) Hilbert function of I. It can be computed explicitly from a given
ﬁnite set of generators of I [2]; actually, several freely available computer algebra systems like,
for instance, CoCoA [3] or Macaulay [11], compute Hilbert functions.

For every contact structure Γ ∈ Cn, let HΓ denote the Hilbert function of its edge ideal.

Corollary 6 For every Γ1, Γ2 ∈ Cn and for every m > 3,

d′
m(Γ1, Γ2) = HΓ1 (m − 1) + HΓ2 (m − 1) − 2HΓ1∪Γ2 (m − 1).

Proof. We have that

M (IΓ1 )m−1∆M (IΓ2 )m−1

= (M (IΓ1 )m−1 − (M (IΓ1 )m−1 ∩ M (IΓ2 )m−1)) ∪ (M (IΓ2 )m−1 − (M (IΓ1 )m−1 ∩ M (IΓ2 )m−1))
= (M (IΓ1 + IΓ2 )m−1 − M (IΓ2 )m−1) ∪ (M (IΓ1 + IΓ2 )m−1 − M (IΓ1 )m−1)
= (C(IΓ2 )m−1 − C(IΓ1 + IΓ2 )m−1) ∪ (C(IΓ1 )m−1 − C(IΓ1 + IΓ2 )m−1)

and thus, this union being disjoint,

|M (IΓ1 )m−1∆M (IΓ2 )m−1|

= (|C(IΓ2 )m−1| − |C(IΓ1 + IΓ2 )m−1|) + (|C(IΓ1 )m−1| − |C(IΓ1 + IΓ2 )m−1|)
= (HΓ2 (m − 1) − HΓ1∪Γ2(m − 1)) + (HΓ1 (m − 1) − HΓ1∪Γ2 (m − 1)),

as we claimed.

To close this section, we want to point out that the metrics d′

m grow with n and m, and
thus it is convenient to normalize them in order to avoid unnecessarily high ﬁgures. More
speciﬁcally, let Γ0 = ([n], ∅) be the empty RNA secondary structure of length n and let Γ1
be an RNA secondary structure of length n with only one contact, say i·j with i < j. Then
IΓ0 = {0}, IΓ1 = IΓ0 + IΓ1 = hxixj i, and therefore, for every m > 3,

d′
m(Γ0, Γ1) = HΓ0(m − 1) − HΓ1 (m − 1),

where

HΓ0 (m − 1) = |M(x)m−1| =(cid:0)n+m−1
(cid:1)

HΓ1 (m − 1) = |M(x1, . . . , xi−1, xi+1, . . . , xn)m−1|

n

+|M(x1, . . . , xj−1, xj+1, . . . , xn)m−1|
−|M(x1, . . . , xi−1, xi+1, . . . , xj−1, xj+1, . . . , xn)m−1|

= 2(cid:0)n+m−2

n−1 (cid:1) −(cid:0)n+m−3
n−2 (cid:1),

10

and hence

d′

m(Γ0, Γ1) =(cid:18)n + m − 1

n

(cid:19) − 2(cid:18)n + m − 2

n − 1 (cid:19) +(cid:18)n + m − 3

n − 2 (cid:19) =(cid:18)n + m − 3

n

(cid:19).

If we take 1 as the “natural” value for the distance between Γ0 and Γ1, then instead of using
the metrics d′

Deﬁnition 3 For every m > 3, the edge ideal mth metric on Cn is

m on Cn, we must divide them by (cid:0)n+m−3
(cid:1).

n

dm(Γ1, Γ2) =

So, for instance, on Cn

1

n

(cid:0)n+m−3
(cid:1)

d′
m(Γ1, Γ2), Γ1, Γ2 ∈ Cn.

d3 = d′
3,

d4 =

1

n + 1

d′
4,

d5 =

d′
5, and so on.

1

(cid:0)n+2
2 (cid:1)

Even after this modiﬁcation, the metric dm is sensitive to n, in the sense that if we add to
two contact structures of a given length n an isolated point, making them contact structures
of length n + 1, then their distance dm (for m ≥ 4: see Proposition 7 below) may grow. For
instance, let Γ0 be again the empty RNA secondary structure of length n ≥ 6 and let now
Γ1 = ([n], {1·3, 4· 6}). Then

dm(Γ0, Γ1) =

(HΓ0 (m − 1) − HΓ1 (m − 1)).

1

which increases with n if m ≥ 5.

Since we are only interested in comparing contact structures of the same length, this sensi-

tiveness of the edge ideal metrics to the length n is not a major drawback.

4 Some computations

In this section we shall compute explicitly some edge ideal mth metrics on Cn and Sn, for low
values of m. We begin with m = 3.

Proposition 7 For every Γ1, Γ2 ∈ Cn,

d3(Γ1, Γ2) = |Q1∆Q2|.

Proof. Notice that M (IΓ)1 = ∅ for every Γ ∈ Cn. Therefore

M (IΓ1 )2∆M (IΓ2 )2 = M (IΓ1 )(2)∆M (IΓ2 )(2) = {xixj | i·j ∈ (Q1 − Q2) ∪ (Q2 − Q1)}

and hence |M (IΓ1 )2∆M (IΓ2 )2| = |Q1∆Q2|.

11

(cid:1), and we shall see in Proposition 14 below

(cid:0)n+m−3
(cid:1)
We have seen above that HΓ0(m − 1) = (cid:0)n+m−1
that (with the convention that (cid:0) i
n(cid:1) = 0 if i < n)

n

n

HΓ1(m − 1) =(cid:18)n + m − 1

n

Therefore,

dm(Γ0, Γ1) =

1

(n+m−3
)

n

n

n

(cid:19) − 2(cid:18)n + m − 3
(cid:19) +(cid:18)n + m − 5
(cid:19).
(2(cid:0)n+m−5
(cid:1) −(cid:0)n+m−3
(cid:1))
(cid:1).(cid:0)n+m−5

(cid:1) = 2 − (m−3)(m−4)

(n+m−3)(n+m−4)

n

n

n

= 2 −(cid:0)n+m−3

n

Actually, it is not diﬃcult to prove that, for every Γ ∈ Sn, the mapping G(Γ) → π3(IΓ) send-
ing every permutation σ = (i1, j1) · · · (il, jl) ∈ G(Γ), with i1·j1, . . . , il·jl ∈ Q, to the equivalence
class of the polynomial xi1 xj1 + · · · + xil xjl ∈ IΓ modulo hM(x)(m)i, is an isomorphism of
groups, considering π3(IΓ) as a subgroup of Rn,3. This is not true for arbitrary contact struc-
tures, because in this case G(Γ) need not be commutative, while π3(IΓ) is always so. Therefore,
the embedding π3 ◦ I : Cn ֒→ Sub(Rn,3) generalizes the embedding G : Sn ֒→ Sub(Sn), and
hence the metric d3 generalizes (up to a scalar factor) the subgroup metric dsgr at a level
deeper than their raw value.

The edge ideal mth metrics for m > 3 have a much more involved expression.

In their
computation we shall use the following lemma; notice that the edge ideals of contact structures
are radical monomial proper (i.e., 6= F2[x]) ideals.

Lemma 8 Let I be a radical monomial proper ideal of F2[x] and, for every k > 1, let SFk(I)
be the number of square free monomials of total degree k belonging to M (I). Then, for every
m > 0,

HI (m) =(cid:18)n + m

n (cid:19) −

m

Xk=1(cid:18)m

k(cid:19)SFk(I).

If I is a radical monomial ideal, then a monomial of the form x

αi
Proof.
ik , with
i1, . . . , ik pairwise diﬀerent and each αit > 1, belongs to M (I) if and only if the corresponding
square free monomial xi1 · · · xik belongs to M (I). Therefore, each one of the SFk(I) square
free monomials xi1 · · · xik of total degree k > 1 in M (I) adds as many monomials x

· · · x

· · · x

αi1
i1

k

k

αi1
i1

αi
ik

t=1 αit 6 m there exist, and the

k(cid:1). Since all monomials in M (I)m added in this way are

k

(cid:1) = (cid:0)m

pairwise diﬀerent and 1 /∈ I by assumption, this proves that

to M (I)m as vectors (αi1 , . . . , αik ) ∈ (N − {0})k such that Pk
number of the latter is (cid:0)k+m−k
k(cid:19)SFk(I),
n (cid:19) −

|C(I)m| = |M(x)m| − |M (I)m| =(cid:18)n + m

Xk=1(cid:18)m

|M (I)m| =

and hence

m

as we claimed.

m

Xk=1(cid:18)m

k(cid:19)SFk(I),

Notice that if Γ ∈ Cn, then SF1(IΓ) = 0 and SF2(IΓ) = |Q|.
Let us compute now d4 on Cn. For every contact structure Γ ∈ Cn, let

A(Γ) =(cid:12)(cid:12)(cid:12)n{i·j, j ·k} ⊆ Q | j 6= ko(cid:12)(cid:12)(cid:12)
T (Γ) =(cid:12)(cid:12)(cid:12)n{i, j, k} ⊆ [n] | i·j, j ·k, i·k ∈ Qo(cid:12)(cid:12)(cid:12)

In other words, A(Γ) and T (Γ) are respectively the numbers of angles and triangles in Γ.
Notice that each triangle contains three diﬀerent angles and therefore 3T (Γ) 6 A(Γ).

Proposition 9 For every Γ1, Γ2 ∈ Cn,

d4(Γ1, Γ2) = |Q1∆Q2|
1

−

n + 1(cid:16)2A(Γ1 ∪ Γ2) − A(Γ1) − A(Γ2) + 2T (Γ1 ∪ Γ2) − T (Γ1) − T (Γ2)(cid:17)

12

Proof. For every Γ = ([n], Q) ∈ Cn we have that

HΓ(3) =(cid:18)n + 3

n (cid:19) − 3SF1(IΓ) − 3SF2(IΓ) − SF3(IΓ),

where SF1(IΓ) = 0 and SF2(IΓ) = |Q|. It remains to compute SF3(IΓ):

(1) For every i·j ∈ Q, there are (n − 2) square free monomials xixjxk in M (IΓ): this makes

(n − 2)|Q| such monomials.

(2) Now, if i · j, j · k ∈ Q form an angle, the monomial xixj xk was counted twice in (1):

therefore, to count these monomials only once, we must subtract A(Γ).

(3) Finally, if the nodes i, j, k form a triangle in Γ, then the monomial xixjxk was counted
three times in (1) and it was subtracted three times in (2); therefore, to retrieve these
monomials, we must add T (Γ) again.

Therefore

and

We have then

SF3(IΓ) = (n − 2)|Q| − A(Γ) + T (Γ)

HΓ(3) =(cid:18)n + 3

n (cid:19) − (n + 1)|Q| + A(Γ) − T (Γ).

d′
4(Γ1, Γ2) = HΓ1(3) + HΓ2(3) − 2HΓ1∪Γ2(3)

=(cid:0)n+3

n (cid:1) − (n + 1)|Q1| + A(Γ1) − T (Γ1) +(cid:0)n+3
−2(cid:16)(cid:0)n+3

n (cid:1) − (n + 1)|Q1 ∪ Q2| + A(Γ1 ∪ Γ2) − T (Γ1 ∪ Γ2)(cid:17)

n (cid:1) − (n + 1)|Q2| + A(Γ2) − T (Γ2)

= (n + 1)|Q1∆Q2| − (2A(Γ1 ∪ Γ2) − A(Γ1) − A(Γ2) + 2T (Γ1 ∪ Γ2) − T (Γ1) − T (Γ2));

in the last equality we have used that 2|Q1 ∪ Q2| − |Q1| − |Q2| = |Q1∆Q2|.

Dividing by n + 1 this last expression for d′

4(Γ1, Γ2), we obtain the expression for d4(Γ1, Γ2)

given in the statement.

A simple computation shows that, for every Γ1, Γ2 ∈ Cn,

2A(Γ1 ∪ Γ2) − A(Γ1) − A(Γ2)

2T (Γ1 ∪ Γ2) − T (Γ1) − T (Γ2)

=(cid:12)(cid:12)(cid:12)n{i·j, j ·k} | i 6= k, (i·j, j ·k ∈ Qs) and (i·j or j ·k /∈ Qt), for some {s, t} = {1, 2}o(cid:12)(cid:12)(cid:12)
+2(cid:12)(cid:12)(cid:12)n{i·j, j ·k} | i·j ∈ Q1 − Q2, j ·k ∈ Q2 − Q1o(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)n{i, j, k} | (i·j, j ·k, i·k ∈ Qs) and (i·j, j ·k or i·k /∈ Qt), for some {s, t} = {1, 2}o(cid:12)(cid:12)(cid:12)
+2(cid:12)(cid:12)(cid:12)n{i, j, k} | i·j, j ·k ∈ Qs and i·k ∈ Qt − Qs, for some {s, t} = {1, 2}o(cid:12)(cid:12)(cid:12)

Example 10 Let Γ0 = ([9], {1·3, 4·6}), and consider the following “modiﬁcations” of it:

Γ1 = ([9], {1·3, 4·6, 7·9}), Γ2 = ([9], {1·3, 4·6, 6·9}), Γ3 = ([9], {1·3, 4·6, 1·6})

Γ4 = ([9], {1·3, 4·7}), Γ5 = ([9], {1·3, 3·6}), Γ6 = ([9], {1·3, 3·5}), Γ7 = ([9], {1·3, 5·7})

13

The contact structures Γ1, Γ2 and Γ3 are obtained by adding a contact to Γ0 in three diﬀerent
ways, Γ4 and Γ5 are obtained by shifting the contact 4 · 6 in two diﬀerent ways, and Γ6 and
Γ7 are obtained by displacing this contact in two more ways. Notice that Γ0, Γ1, Γ4 and Γ7 are
RNA secondary structures, but not the others.

We have that

d3(Γ0, Γ1) = d3(Γ0, Γ2) = d3(Γ0, Γ3) = 1,

d3(Γ0, Γ4) = d3(Γ0, Γ5) = d3(Γ0, Γ6) = d3(Γ0, Γ7) = 2,

while

d4(Γ0, Γ1) = 1,

d4(Γ0, Γ2) = 0.9,

d4(Γ0, Γ3) = 0.8,

d4(Γ0, Γ4) = 1.8,

d4(Γ0, Γ5) = 1.7,

d4(Γ0, Γ6) = 1.9,

d4(Γ0, Γ7) = 2

The expression for d4 on RNA secondary structures is much simpler. Recall that, for every
Γ1, Γ2 ∈ Sn, Λ≥2 stands for the number of linear orbits of length > 2, i.e., of non-trivial linear
orbits induced by the action of D(Γ1, Γ2) on [n].

Proposition 11 For every Γ1, Γ2 ∈ Sn,

d4(Γ1, Γ2) = |Q1∆Q2| − 2

n+1 A(Γ1 ∪ Γ2)

= |Q1∆Q2| − 2

n+1 (|Q1∆Q2| − Λ≥2).

Proof. Notice that the unique bonds condition implies in this case that

A(Γ1) = A(Γ2) = T (Γ1) = T (Γ2) = T (Γ1 ∪ Γ2) = 0,

from which the ﬁrst equality follows. It remains to prove that if Γ1, Γ2 ∈ SE, then

A(Γ1 ∪ Γ2) = |Q1∆Q2| − Λ≥2.

To prove it, notice that if {i·j, j·k} forms an angle in Γ1 ∪ Γ2, then, again by the unique bonds
condition, one these contacts must belong to Q1 − Q2 and the other one to Q2 − Q1, and the
nodes i, j, k belong to the same orbit of length at least 3. Now, each cyclic orbit of length
m > 2 contains m such pairs of contacts, while any linear orbit of length m > 2 contains m − 2
such pairs. Then

A(Γ1 ∪ Γ2) =Pm≥4 mΘ(m) +Pm≥2(m − 2)Λ(m)

=Pm≥4 mΘ(m) +Pm≥2(m − 1)Λ(m) −Pm≥2 Λ(m) = |Q1∆Q2| − Λ≥2,

as we wanted to prove.

Therefore, on Sn, the metric d4 increases with the cardinal of Q1∆Q2, but decreases with

the number of pairs of contacts in Q1∆Q2 that share a node. Notice moreover that

0 6 |Q1∆Q2| − Λ≥2 6 |Q1∆Q2|;

the lower bound is achieved when all non-trivial orbits are linear of length 2 (i.e., when Γ1 ∪ Γ2
is again an RNA secondary structure), and the upper bound when all non-trivial orbits are
cyclic (i.e., when Γ1 and Γ2 have exactly the same isolated nodes).

14

Example 12 According to [22, §5.3.2], most RNA AU-sequences of length 16 do not fold at
all, i.e., they form the empty RNA secondary structure Γ0 = ([16], ∅). But some of these
sequences (about a 3% of them) do fold, forming one of the following three RNA secondary
structures without pseudoknots:

Γ1 : .((((((...))))))

Γ2 : ((((((...)))))).

Γ3 : ((((((....))))))

Recall that these are the bracket representations of

Γ1 =(cid:16)[16], {2·16, 3·15, 4·14, 5·13, 6·12, 7·11}(cid:17)
Γ2 =(cid:16)[16], {1·15, 2·14, 3·13, 4·12, 5·11, 6·10}(cid:17)
Γ3 =(cid:16)[16], {1·16, 2·15, 3·14, 4·13, 5·12, 6·11}(cid:17)

They have pairwise disjoint sets of contacts, and hence

But

d3(Γ1, Γ2) = d3(Γ1, Γ3) = d3(Γ2, Γ3) = 12.

d4(Γ1, Γ2) =

184
17

, d4(Γ1, Γ3) = d4(Γ2, Γ3) =

182
17

,

which shows that, under d4, Γ1 and Γ2 are closer to Γ3 than to each other.

Example 13 Let us consider a hairpin with an interior loop Γ0 ∈ S21 with bracket represen-
tation

((.((((...)))).....))

One possible rearrangement of this secondary structure splits the hairpin into a multibranched
loop by means of two shift moves, yielding a multibranched structure:

Γ0 : ((.((((...)))).....)) =⇒ Γ1 : ((..(((...)))(...).)) =⇒ Γ2 : ((...((...))((...))))

Another possible rearrangement through shift moves widens the ﬁnal loop of the hairpin by
moving a one-nucleotide bulge:

Γ0 : ((.((((...)))).....)) =⇒ Γ′
=⇒ Γ′

1 : (((.(((...)))).....)) =⇒ Γ′
3 : (((((.(...)))).....)) =⇒ Γ′

2 : ((((.((...)))).....))
4 : ((((((....)))).....))

Now notice that

But, although

it turns out that

d3(Γ0, Γ1) = d3(Γ0, Γ′

1) = 2, d3(Γ0, Γ2) = d3(Γ0, Γ′

2) = 4.

d4(Γ0, Γ1) = d4(Γ0, Γ′

1) =

21
11

,

d4(Γ0, Γ2) =

42
11

,

d4(Γ0, Γ′

2) =

41
11

.

Therefore, under d4, Γ′

2 is closer to Γ0 than Γ2.

15

As m grows, the description of dm on Cn gets more and more involved or, if we want it to
remain simple, more and more uninformative. The same happens on Sn, but at a lower pace.
Therefore, from now on, we shall only consider edge metrics on RNA secondary structures.

We have a closed formula for the Hilbert function of the edge ideal of an RNA secondary
structure, given by the following result, which we consider interesting in itself. In it we use the

convention that (cid:0)0

0(cid:1) = 1 and (cid:0)0

j(cid:1) = 0 if j > 0.

Proposition 14 For every Γ = ([n], Q) ∈ Sn and for every m > 0,

HΓ(m) =

⌊m/2⌋

Xj=0

(−1)j(cid:18)|Q|

j (cid:19)(cid:18)n + m − 2j

n

(cid:19).

Proof. To begin with, notice that the Hilbert function HΓ only depends on |Q| because, for
every two RNA secondary structures Γ1, Γ2 with the same number of contacts, their edge ideals
are the same up to a permutation of the variables and thus |C(IΓ1 )m| = |C(IΓ2 )m| for every
m > 0. For every k > 0, let Hk denote the Hilbert function of the edge ideal of any Γ ∈ Sn
with |Q| = k.

Now, notice that if Γ = ([n], Q) ∈ Sn with Q = {i1·j1, . . . , ik ·jk}, then no monomial xit xjt ,
for t = 1, . . . , k, is a zero divisor modulo the ideal hxi1 xj1 , . . . , xit−1 xjt−1 i. This implies, by [6,
§9.4, Cor. 5] (or, rather, its proof) that

Hk+1(m) = Hk(m) − Hk(m − 2), for every k > 0, m > 2,

and hence

k

Hk+1(m) = H0(m) −

Hi(m − 2), for every k > 0, m > 2;

Xi=0

we shall use this recursion to prove the expression in the statement by induction on m.

To begin with, we know that

H0(m) = |M(x)m| =(cid:18)n + m

n (cid:19), for every m > 0,

which clearly satisﬁes the expression in the statement (with |Q| = 0). Moreover,

Hk(0) = 1, Hk(1) = n + 1 for every k > 0,

because, for every Γ ∈ Sn,

C(IΓ)0 = {1}, C(IΓ)1 = {1, x1, . . . , xn}.

These values for Hk(0) and Hk(1) clearly satisfy the expression given in the statement. Now,
as induction hypothesis, assume that

Hk(m0) =

⌊m0/2⌋

Xj=0

(−1)j(cid:18)k

j(cid:19)(cid:18)n + m0 − 2j

n

(cid:19) for every k > 0.

16

Then, for every k > 0,

i=0 Hi(m0)

j=0

i=0P⌊m0/2⌋

n

Hk+1(m0 + 2) = H0(m0 + 2) −Pk
(cid:1) −Pk
(cid:1) +P⌊m0/2⌋
(cid:1) +P⌊m0/2⌋
0 (cid:1)(cid:0)n+m0+2
(−1)j(cid:0)k+1

=(cid:0)n+m0+2
=(cid:0)n+m0+2
=(cid:0)n+m0+2
= (−1)0(cid:0)k+1
=P⌊(m0+2)/2⌋

j=0

j=0

j=0

n

n

n

n

n

(−1)j(cid:0)i

j(cid:1)(cid:0)n+m0−2j
(cid:1)
(cid:1)(cid:16)Pk
j(cid:1)(cid:17)
(−1)j+1(cid:0)n+m0−2j
i=0(cid:0)i
(−1)j+1(cid:0)n+m0−2j
(cid:1)(cid:0)k+1
j+1(cid:1)
(cid:1) +P⌊m0/2⌋+1
(−1)j(cid:0)k+1
j (cid:1)(cid:0)n+m0+2−2j
j (cid:1)(cid:0)n+m0+2−2j
(cid:1),

j=1

n

n

n

(cid:1)

where the second equality uses the induction hypothesis and the fourth equality uses that

Pk
i=0(cid:0)i

j(cid:1) =(cid:0)k+1
j+1(cid:1).

Thus, for instance, for every Γ = ([n], Q) ∈ Sn,

HIΓ (2) =(cid:0)n+2
HIΓ (3) =(cid:0)n+3
HIΓ (4) =(cid:0)n+4
HIΓ (5) =(cid:0)n+5
HIΓ (6) =(cid:0)n+6

2 (cid:1) − |Q|
3 (cid:1) − (n + 1)|Q|
4 (cid:1) −(cid:0)n+2
5 (cid:1) −(cid:0)n+3
6 (cid:1) −(cid:0)n+4

2 (cid:1)|Q| +(cid:0)|Q|
2 (cid:1)
3 (cid:1)|Q| + (n + 1)(cid:0)|Q|
2 (cid:1)
4 (cid:1)|Q| +(cid:0)n+2
2 (cid:1)(cid:0)|Q|
2 (cid:1) −(cid:0)|Q|
3 (cid:1)

Unfortunately, we do not have a similar explicit expression for the Hilbert function of arbi-
trary contact structures, including unions of RNA secondary structures, and then we still use
Lemma 8 to compute the Hilbert functions of the latter.

To close this paper, we shall provide explicit descriptions of d5 and d6 on the set Sn just to
grasp what they measure. Their proofs are simple, but long and technically involved, and we
delay them until the Appendix at the end of this paper.

Proposition 15 For every Γ1, Γ2 ∈ Sn,

d5(Γ1, Γ2) = |Q1∆Q2|

− 1
(n+2

2 )(cid:16)2(n − 1)(|Q1∆Q2| − Λ≥2) + 2(cid:0)|Q1∪Q2|

2

(cid:1) −(cid:0)|Q1|

2 (cid:1) −(cid:0)|Q2|

2 (cid:1) + 2(Λ≥3 + Θ(4))(cid:17)

Example 16 Consider the RNA secondary structures of length 15

Then

and

but

Γ1 : (.).(.).(.).(.), Γ2 : ....(.(.).(.).), Γ3 : ..(.).(.).(.)..

d3(Γ1, Γ2) = d3(Γ1, Γ3) = 7

d4(Γ1, Γ2) = d4(Γ1, Γ3) =

25
4

,

d5(Γ1, Γ2) = 5 +

71
136

,

d5(Γ1, Γ3) = 5 +

69
136

.

Thus, under d5, Γ3 is closer to Γ1 than to Γ2.

17

It is interesting to observe that, contrary to what happens with d3 and d4, the term

2(cid:0)|Q1∪Q2|

and structure of the set Q1∆Q2, but also on |Q1 ∩ Q2|. For instance, it is not diﬃcult to check
that if Γ1, Γ2, Γ′

2 (cid:1) makes the value of d5(Γ1, Γ2) depend not only on the cardinal

2 ∈ Sn are such that Q1 − Q2 = Q′

2 and Q2 − Q1 = Q′

(cid:1) − (cid:0)|Q1|

2 (cid:1) − (cid:0)|Q2|

1 − Q′

2 − Q′

1, then

1, Γ′

2

d5(Γ1, Γ2) < d5(Γ′

1, Γ′

2) ⇐⇒ |Q1 ∩ Q2| > |Q′

1 ∩ Q′

2|;

i.e., the greater the set of contacts they share is, the closer they are.

Example 17 Consider again the hairpin with an interior loop Γ0 and its rearrangement Γ1
given in Example 13

Γ0 : ((.((((...)))).....)), Γ1 : ((..(((...)))(...).)).

Let now Γ′
from Γ0 and Γ1 their outer stacked pair of contacts:

0 and Γ′

1 be the RNA secondary structures of the same length 21 obtained by removing

Γ′
0 : ...((((...))))......., Γ′

1 : ....(((...)))(...)....

Since Q1∆Q2 = Q′

1∆Q′

2 = {4·14, 14·18}, we have that

d3(Γ0, Γ1) = d3(Γ′

0, Γ′

1) = 2, d4(Γ0, Γ1) = d4(Γ′

0, Γ′

1) =

21
11

But it turns out that

d5(Γ0, Γ1) = 1 +

201
253

,

d5(Γ′

0, Γ′

1) = 1 +

205
253

.

As far as d6 goes, we have the following result.

Proposition 18 For every Γ1, Γ2 ∈ Sn,

3 )(cid:16)(n + 1)(2(cid:0)|Q1∪Q2|

2

(cid:1) −(cid:0)|Q1|

2 (cid:1) −(cid:0)|Q2|
2 (cid:1))

d6(Γ1, Γ2) = |Q1∆Q2| − 1
(n+3

+2((cid:0)n

2(cid:1) + 3 − |Q1 ∪ Q2|)(|Q1∆Q2| − Λ≥2) − 2(n − 1)Λ≥3 + 2Λ≥4 + 2(n − 3)Θ(4)(cid:17)

In a similar way, an explicit expression for dm on Sn can be obtained for every m > 7, yielding
information about what these metrics measure: recall moreover that, for speciﬁc Γ1, Γ2 ∈ Sn,
the value of dm(Γ1, Γ2) can be easily computed using a suitable computer algebra system.
Unfortunately, we have not been able to produce a closed expression for all these metrics.
Notice that, when ﬁnding an expression for dm, the only new ingredient that is necessary
to determine is the coeﬃcient SFm−1(IΓ1 ∪ IΓ2 ), which can be done for each m by counting
carefully how many square-free monomials of total degree m − 1 belong to IΓ1 ∪ IΓ2 as we do
in this paper for m = 4, 5, 6. It is in this coeﬃcient that new terms make their appearance
in each dm: when one balances the number of square-free monomials in IΓ1 ∪ IΓ2 of the form
xi1 · · · xim−1 such that i1 · i2, . . . , im−2 · im−1 ∈ Q1 ∪ Q2, the number Λ(m−2) makes its ﬁrst
appearance, and if m − 1 is even, then to counterbalance the number of square-free monomials
such that {i1, . . . , im−1} is a cyclic orbit, the number Ω(m−1) must be
xi1 · · · xim−1 in IΓ1∪IΓ2
used for the ﬁrst time (cf. the proofs of Propositions 15 and 18 in the Appendix).

18

5 Conclusion

In the Discussion section of their paper [18], Reidys and Stadler, having pointed out that their
group-based models and metrics cannot be used on arbitrary contact structures, ask “What
if contacts are not unique as in the case of proteins?” Using edge ideals, we can represent
arbitrary contact structures by means of monomial ideals of a polynomial ring, and we show
that this representation generalizes the embedding of RNA secondary structures into the set
of subgroups of Sn proposed by Reidys and Stadler. We have used then this representation
to deﬁne a family of edge ideal metrics on arbitrary contact structures, which can be easily
computed using several freely available computer algebra systems, and we have studied their
properties.

Edge ideals are not the unique possible monomial ideal representations of arbitrary contact
structures. For instance, we could associate to every contact structure Γ = ([n], Q) the clique
ideal JΓ of F2[x1, . . . , xn] generated by the set of monomials consisting of one square-free
monomial xi1 · · · xik for each non-trivial clique (complete subgraph) {i1, . . . , ik}, with k > 2,
of Γ. Notice that if Γ is an RNA secondary structure, then JΓ = IΓ, but for arbitrary contact
structures they can be diﬀerent. For instance, if Γ = ([5], {1·3, 3·5, 1·5}), then

IΓ = hx1x3, x1x5, x3x5

i while

JΓ = hx1x3x5i.

We see that the clique ideal JΓ captures information on the clusters of monomers in three-
dimensional structures (for instance, base triplets and quartets in RNA structures) in a way
diﬀerent to IΓ. These ideals can be used to deﬁne new metrics on arbitrary contact structures
of a ﬁxed length similar to the edge ideal metrics introduced here. We shall report on them in
a subsequent paper.

Let us ﬁnally point out that another question of Reidys and Stadler’s remains open for our
models as well as, to our knowledge, for theirs: “Is there any hope for extending or altering
any of the above concepts in order to incorporate variable sizes of structures?”

Acknowledgments. We acknowledge with thanks X. Bordoy, J. Elias, J. Mir´o and G. Valiente
for several discussions on the topic of this paper and for their comments on draft versions of
it.

References

[1] R. T. Batey, R. P. Rambo, J. A. Doudna, Tertiary motifs and folding of RNA, Angew.

Chem. Int. Ed. 38 (1999), 2326–2343.

[2] A. M. Bigatti, Computation of Hilbert-Poincare series, J. Pure Appl. Alg. 119 (1997),

237-253.

[3] A. Capani, G. Niesi, L. Robbiano, CoCoA, a system for doing Computations in Commu-

tative Algebra, available via anonymous ftp from cocoa.dima.unige.it.

[4] H. S. Chan, K. A. Dill, Compact polymers, Macromolecules 22, (1989), 4559–4573.

[5] H. S. Chan, K. A. Dill, Sequence space soup of proteins and copolymers, J. Chem. Phys.

95, (1991), 3775–3779.

19

[6] D. Cox, J. Little, D. O’Shea, Ideals, Varieties, and Algorithms (second ed.), Springer-

Verlag (1997).

[7] K. A. Dill, S. Bromberg, K. Yue, K. M. Fiebig, D. P. Yeo, P. D. Thomas, H. S. Chan,
Principles of protein folding: A perspective from simple exact models, Prot. Sci. 4 (1995),
561-602.

[8] J. Casasnovas, J. Mir´o, F. Rossell´o, On the algebraic representation of RNA sec-
ondary structures with G.U pairs, to appear in Journal of Mathematical Biology (DOI:
10.1007/s00285-002-0188-0).

[9] W. Fontana, D. Konings, P. Stadler, P. Schuster, Statistics of RNA secondary structures,

Biopolymers 33 (1993), 1389–1404.

[10] W. Fontana, P. Schuster, Shaping space: the possible and the attainable in RNA genotype-

phenotype mapping, J. Theor. Biol. 194 (1998), 491–515.

[11] D. R. Grayson, M. Stillman, Macaulay

2,

software

system available

at

http://www.math.uiuc.edu/Macaulay2/.

[12] C. Haslinger, P. F. Stadler, RNA structures with pseudo-knots: Graph-theoretical, com-

binatorial, and statistical properties, Bull. Math. Biol. 61 (1999), 437–467.

[13] I. Hofacker, W. Fontana, P. Stadler, L. Bonhoeﬀer, M. Tacker, P. Schuster, Fast folding

and comparison of RNA secondary structures, Monatsh. Chem. 125 (1994), 167–188.

[14] N. Madras, G. Sokal, The self-avoiding walk, Birkh¨auser (1993).

[15] Y. Magarshak, C. J. Benham, An algebraic representation of RNA secondary structures,

J. of Biomol. Struct. & Dyn. 10 (1992) 465–488.

[16] P. B. Moore, Structural motifs in RNA, Annu. Rev. Biochem., 68 (1999), 287–300.

[17] V. Moulton, M. Zuker, M. Steel, R. Pointon, D. Penny, Metrics on RNA secondary struc-

tures, J. Comp. Biol. 7 (2000), 277–292.

[18] C. Reidys, P. F. Stadler, Bio-molecular shapes and algebraic structures, Comp. & Chem.

20 (1996), 85–94.

[19] F. Rossell´o, On Reidys and Stadler’s metrics

for RNA secondary structures,

http://xxx.lanl.gov/pdf/math.GM/0305222, submitted.

[20] B. Shapiro, K. Zhang, Comparing multiple RNA secondary structures using tree compar-

isons, CABIOS 6 (1990), 309-318.

[21] P. Schuster, W. Fontana, P. Stadler, I. Hofacker, From sequences to shapes and back: a

case study in RNA secondary structures, Proc. Roy. Soc. B 255 (1994), 279–284.

[22] P. Schuster, P. F. Stadler, Discrete models of biopolymers, to appear in Handbook of Com-
putational Chemistry (M.J.C. Crabbe, M. Drew and A. Konopka, eds.), Marcel Dekker
(in press); see also Univ. Wien TBI Preprint No. pks-99-012 (1999).

20

[23] A. Simis, W. Vasconcelos, R. Villarreal, On the ideal theory of graphs, J. Algebra 167

(1994), 389–416.

[24] R. Villarreal, Monomial ideals, Marcel-Dekker (2000).

[25] M. S. Waterman, T. F. Smith, RNA seconadry structure: a complete mathematical anal-

ysis, Math. Biosci. 42 (1978), 257–266.

[26] M. Zuker, On ﬁnding all suboptimal foldings of an RNA molecule, Science 244 (1989),

48–52.

[27] M. Zuker, The use of dynamic programming algorithms in RNA secondary structure
prediction, In Mathematical methods for DNA sequences (M. Waterman, ed.), CRC Press
(1989), 159–184.

[28] M. Zuker, D. Sankoﬀ, RNA secondary structures and their prediction, Bull. Math. Biol.

46 (1984), 591–621.

Appendix: Proof of Propositions 15 and 18

To simplify the proofs, we establish ﬁrst a lemma that we shall use several times and that generalizes
the computation of A(Γ1 ∪ Γ2) carried on in the proof of Proposition 11.

For every Γ1, Γ2 ∈ Sn and for every k > 2, let

Mk = {{i1 ·i2, i2 ·i3, . . . , ik ·ik+1} ⊆∈ Q1 ∪ Q2 | i1, . . . , ik pairwise diﬀerent},

and let Ak be its cardinal. Notice that A2 is equal to the number of angles A(Γ1 ∪ IΓ2) in Γ1 ∪ Γ2. To
simplify the notations, from now on we shall systematically write A2 instead of A(Γ1 ∪ IΓ2 ).

Lemma A For every Γ1, Γ2 ∈ Sn and for every k > 2,

Ak = |Q1∆Q2| −

mΘ(m) −

k

Xm=4

Λ≥i.

k

Xi=2

If {i1 ·i2, , . . . , ik ·ik+1} ∈ Mk, then the nodes i1, i2, . . . , ik+1 belong to the same orbit, whose
Proof.
length will be at least k + 1. Therefore, every cyclic orbit of length m 6 k contributes no element to
Mk, while every cyclic orbit of length m > k + 1 adds m new elements to it. On the other hand, each
linear orbit of length m 6 k contributes no element to Mk, while every linear orbit of length m > k + 1
adds m − k new elements to this set.

This shows that

Ak =Pm>k mΘ(m) +Pm>k(m − k)Λ(m)

=Pm>k mΘ(m) +Pm>k(m − 1)Λ(m) − (k − 1)Pm>k Λ(m)
= |Q1∆Q2| −Pk
= |Q1∆Q2| −Pk

m=4 mΘ(m) −Pk
m=4 mΘ(m) −Pk

m=2(m − 1)Λ(m) − (k − 1)Pm>k Λ(m)

i=2 Λ≥i.

21

In particular, we obtain again that A2 = |Q1∆Q2| − Λ≥2, as we already saw in the proof of

Proposition 11.

Proof of Proposition 15. To simplify the notations, we shall denote each SFi(IΓ1∪Γ2 ) simply by SFi.
We shall use the expression

where we already know that

1

d5(Γ1, Γ2) =

2 (cid:1)(cid:16)HΓ1 (4) + HΓ2(4) − 2HΓ1∪Γ2 (4)(cid:17),
(cid:0)n+2
4 (cid:1) −(cid:0)n+2
HΓi(4) =(cid:0)n+4

2 (cid:1)|Qi| +(cid:0)|Qi|
2 (cid:1),

n (cid:1) − (4SF1 + 6SF2 + 4SF3 + SF4)

(4) =(cid:0)n+4

HΓ1∪IΓ2

i = 1, 2

with

SF1 = 0, SF2 = |Q1 ∪ Q2|, SF3 = (n − 2)|Q1 ∪ Q2| − A2;

the value of SF3 was obtained in the proof of Proposition 9: notice that T (Γ1 ∪ Γ2) = 0 and recall
that A(Γ1 ∪ Γ2) = A2. It remains to compute SF4:

(2) Now, if i·j, k·l ∈ Q1 ∪ Q2 with {i, j} ∩ {k, l} = ∅, then the monomial xixjxkxl is counted twice

2 (cid:1) square free monomials xixjxkxl ∈ M (IΓ1∪Γ2). This

(1) For every i·j ∈ Q1 ∪ Q2, there are (cid:0)n−2
2 (cid:1)|Q1 ∪ Q2| such monomials.

makes (cid:0)n−2
in (1). Therefore, we must subtract (cid:0)|Q1∪Q2|

2

(cid:1) − A2 to the value given in (1).

(3) If i·j, j·k ∈ Q1 ∪ Q2 form an angle in Γ1 ∪ Γ2, then for every l /∈ {i, j, k} the monomial xixjxkxl

is counted twice in (1). Thus, we must also subtract (n − 3)A2.

(4) If i·j, j·k, k·l ∈ Q1 ∪ Q2, with i, j, k, l pairwise diﬀerent, then the monomial xixjxkxl is counted
three times in (1), then it is subtracted once in (2) and it is subtracted twice in (3). Therefore,
to retrieve these monomials, we must add A3.

(5) Finally, if i·j, j·k, k·l, l·i ∈ Q1 ∪ Q2, so that if {i, j, k, l} form a cyclic orbit of length 4, then the
monomial xixjxkxl is counted four times in (1), it is subtracted twice in (2), it is subtracted
four more times in (3) and it is added four times in (4). To balance these operations, we must
subtract Θ(4).

In all, this shows that

SF4 = n − 2

2 !|Q1 ∪ Q2| − |Q1 ∪ Q2|

2

! − (n − 4)A2 + A3 − Θ(4)

and hence

HΓ1∪Γ2 (4) = n + 4

4 ! − n + 2

2 !|Q1 ∪ Q2| + |Q1 ∪ Q2|

2

! + nA2 − A3 + Θ(4).

A simple computation shows then that

d′
5(Γ1, Γ2) = HΓ1 (4) + HΓ2(4) − 2HΓ1∪Γ2 (4)

= 2(cid:0)n+4
=(cid:0)n+2

4 (cid:1) −(cid:0)n+2
−2(cid:16)(cid:0)n+4
2 (cid:1)|Q1∆Q2| −(cid:16)2(cid:0)|Q1∪Q2|

2 (cid:1)(|Q1| + |Q2|) +(cid:0)|Q1|
4 (cid:1) −(cid:0)n+2
(cid:1) −(cid:0)|Q1|

2 (cid:1) +(cid:0)|Q2|
2 (cid:1)
(cid:1) + nA2 − A3 + Θ(4)(cid:17)
2 (cid:1)|Q1 ∪ Q2| +(cid:0)|Q1∪Q2|
2 (cid:1) + 2nA2 − 2A3 + 2Θ(4)(cid:17)
2 (cid:1) −(cid:0)|Q2|

2

2

Now, we know from Lemma A that

A2 = |Q1∆Q2| − Λ≥2, A3 = |Q1∆Q2| − Λ≥2 − Λ≥3.

22

Replacing them in the expression obtained above for d′

5(Γ1, Γ2), and dividing the resulting expression

by (cid:0)n+2

d5(Γ1, Γ2) = |Q1∆Q2|

2 (cid:1), we ﬁnally obtain
2 )(cid:16)2(cid:0)|Q1∪Q2|

− 1
(n+2

2

as we wanted to prove.

(cid:1) −(cid:0)|Q1|

2 (cid:1) −(cid:0)|Q2|

2 (cid:1) + 2(n − 1)(|Q1∆Q2| − Λ≥2) + 2(Λ≥3 + Θ(4))(cid:17),

Proof of Proposition 18. To simplify the notations, we shall denote again SFi(IΓ1∪Γ2 ) simply by SFi.
In the expression

we already know that

with

Let us compute now SF5:

d6(Γ1, Γ2) =

HΓi (5) =(cid:0)n+5

HΓ1∪IΓ2

1

3 (cid:1)(cid:16)HΓ1 (5) + HΓ2(5) − 2HΓ1∪Γ2 (5)(cid:17),
(cid:0)n+3
3 (cid:1)|Qi| + (n + 1)(cid:0)|Qi|
5 (cid:1) −(cid:0)n+3
2 (cid:1),

(5) =(cid:0)n+5
2 (cid:1)|Q1 ∪ Q2| −(cid:0)|Q1∪Q2|

n (cid:1) − (5SF1 + 10SF2 + 10SF3 + 5SF4 + SF5)
(cid:1) − (n − 4)A2 + A3 − Θ(4)

i = 1, 2

2

SF1 = 0, SF2 = |Q1 ∪ Q2|, SF3 = (n − 2)|Q1 ∪ Q2| − A2

SF4 =(cid:0)n−2

(1).

(2) Now, if i·j, k ·l ∈ Q1 ∪ Q2 with {i, j} ∩ {k, l} = ∅, then for every m /∈ {i, j, k, l} the monomial

(1) For every i·j ∈ Q1 ∪ Q2, there are (cid:0)n−2
3 (cid:1)|Q1 ∪ Q2| such monomials.

3 (cid:1) square free monomials xixjxkxlxm ∈ M (IΓ1∪Γ2 ). This
(cid:1) − A2(cid:17) to

makes (cid:0)n−2
xixjxkxlxm is counted twice in (1). Therefore, we must subtract (n − 4)(cid:16)(cid:0)|Q1∪Q2|
in (1). Therefore, we must also subtract (cid:0)n−3

(4) If i·j, j·k, l·m ∈ Q1 ∪ Q2 with {i, j, k} ∩ {l, m} = ∅, the monomial xixjxkxlxm is counted 3 times
in (1), then it is subtracted twice in (2) and it is subtracted once again in (3). Therefore, to
retrieve these monomials we must add

(3) If i·j, j ·k ∈ Q1 ∪ Q2, then for every l, m /∈ {i, j, k} the monomial xixjxkxlxm is counted twice

2 (cid:1)A2 to (1).

2

(cid:12)(cid:12)(cid:12)n{i·j, j ·k, l·m} | i·j, j ·k, l·m ∈ Q1 ∪ Q2, {i, j, k} ∩ {l, m} = ∅o(cid:12)(cid:12)(cid:12)

let us call for the moment X this number.

;

(5) If i·j, j ·k, k·l ∈ Q1 ∪ Q2, for every m /∈ {i, j, k, l} the monomial xixjxkxlxm is counted 3 times
in (1), then it is subtracted once in (2) and it is subtracted twice in (3). Therefore, to retrieve
these monomials we must also add (n − 4)A3 monomials.
Notice now that

X + A3 =(cid:12)(cid:12)(cid:12)n{i·j, j ·k, l·m} | i·j, j ·k, l·m ∈ Q1 ∪ Q2o(cid:12)(cid:12)(cid:12)

Therefore, (4) and (5) add jointly

= (|Q1 ∪ Q2| − 2)A2.

(|Q1 ∪ Q2| − 2)A2 + (n − 5)A3

monomials.

23

(6) If i · j, j · k, k · l, l · i ∈ Q1 ∪ Q2, i.e., if {i, j, k, l} form a cyclic orbit of length 4, then for every
m /∈ {i, j, k, l} the monomial xixj xkxlxm is counted four times in (1), it is subtracted twice in
(2), it is subtracted four more times in (3) and it is added four times in (5). Therefore, we must
subtract (n − 4)Θ(4).

(7) Finally, if i·j, j ·k, k ·l, l·m ∈ Q1 ∪ Q2, then the monomial xixjxkxlxm is counted four times in
(1), it is subtracted three times in (2), it is subtracted three more times in (3) and it is added
twice in (4) and twice in (5). Therefore, we must subtract A4.

In all, this shows that

SF5 =(cid:0)n−2

3 (cid:1)|Q1 ∪ Q2| − (n − 4)((cid:0)|Q1∪Q2|

2

(cid:1) − A2) −(cid:0)n−3

2 (cid:1)A2

+(|Q1 ∪ Q2| − 2)A2 + (n − 5)A3 − (n − 4)Θ(4) − A4

and hence

HΓ1∪Γ2(5) =(cid:0)n+5

5 (cid:1) −(cid:0)n+3

3 (cid:1)|Q1 ∪ Q2| + (n + 1)(cid:0)|Q1∪Q2|

−nA3 + (n + 1)Θ(4) + A4.

2

(cid:1) + ((cid:0)n+1

2 (cid:1) − |Q1 ∪ Q2| + 2)A2

Then

d′
6(Γ1, Γ2) = HΓ1(5) + HΓ2 (5) − 2HΓ1∪Γ2(5)

= 2(cid:0)n+5
5 (cid:1) −(cid:0)n+3
3 (cid:1)(|Q1| + |Q2|) + (n + 1)((cid:0)|Q1|
−2(cid:16)(cid:0)n+5
5 (cid:1) −(cid:0)n+3
3 (cid:1)|Q1 ∪ Q2| + (n + 1)(cid:0)|Q1∪Q2|
2 (cid:1) − |Q1 ∪ Q2| + 2)A2 − nA3 + (n + 1)Θ(4) + A4(cid:17)
+((cid:0)n+1
3 (cid:1)|Q1∆Q2| − (n + 1)(cid:16)2(cid:0)|Q1∪Q2|
2 (cid:1)(cid:17) − 2(cid:16)(cid:0)n+1
=(cid:0)n+3
(cid:1) −(cid:0)|Q1|

2 (cid:1) +(cid:0)|Q2|
2 (cid:1))

+2nA3 − 2(n + 1)Θ(4) − 2A4.

2 (cid:1) −(cid:0)|Q2|

(cid:1)

2

2

2 (cid:1) + 2 − |Q1 ∪ Q2|(cid:17)A2

Since we already know, by Lemma A, that

A2 = |Q1∆Q2| − Λ≥2, A3 = |Q1∆Q2| − Λ≥2 − Λ≥3

A4 = |Q1∆Q2| − Λ≥2 − Λ≥3 − Λ≥4 − 4Θ(4)

when we replace these values in the expression obtained above for d′

6(Γ1, Γ2) and we divide the resulting

expression by (cid:0)n+3
3 (cid:1), we ﬁnally obtain
2(cid:1) + 3 − |Q1 ∪ Q2|)(|Q1∆Q2| − Λ≥2) − 2(n − 1)Λ≥3 + 2Λ≥4 + 2(n − 3)Θ(4)(cid:17)
+2((cid:0)n

3 )(cid:16)(n + 1)(2(cid:0)|Q1∪Q2|

d6(Γ1, Γ2) = |Q1∆Q2| − 1
(n+3

2 (cid:1) −(cid:0)|Q2|
2 (cid:1))

(cid:1) −(cid:0)|Q1|

2

24

